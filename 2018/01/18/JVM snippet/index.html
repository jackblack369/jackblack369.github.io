<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="JRE JVM JDK JRE:    java run-time   Java is every where in browser, in mobile, in TV or in set-top boxes and if you are into Java programming language than you know that Java code which is bundled in">
<meta property="og:type" content="article">
<meta property="og:title" content="jvm snippet">
<meta property="og:url" content="https://www.willshirley.top/2018/01/18/JVM%20snippet/index.html">
<meta property="og:site_name" content="Discipline &amp; Reflect">
<meta property="og:description" content="JRE JVM JDK JRE:    java run-time   Java is every where in browser, in mobile, in TV or in set-top boxes and if you are into Java programming language than you know that Java code which is bundled in">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.imgur.com/yI8u4Hr.jpg">
<meta property="og:image" content="https://i.imgur.com/57IalMb.png">
<meta property="og:image" content="https://i.imgur.com/9hHykjw.png">
<meta property="og:image" content="https://i.imgur.com/KKpqYVn.png">
<meta property="og:image" content="https://i.imgur.com/jTM8BJz.png">
<meta property="article:published_time" content="2018-01-18T14:00:30.000Z">
<meta property="article:modified_time" content="2024-08-27T09:25:26.987Z">
<meta property="article:author" content="brook">
<meta property="article:tag" content="snippet">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.imgur.com/yI8u4Hr.jpg">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>jvm snippet</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="Discipline & Reflect" type="application/atom+xml">
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/archives/">Log</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2018/02/16/redis%20snippet/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2018/01/09/maven%20snippet/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://www.willshirley.top/2018/01/18/JVM%20snippet/&text=jvm snippet"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://www.willshirley.top/2018/01/18/JVM%20snippet/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=jvm snippet&body=Check out this article: https://www.willshirley.top/2018/01/18/JVM%20snippet/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://www.willshirley.top/2018/01/18/JVM%20snippet/&title=jvm snippet"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://www.willshirley.top/2018/01/18/JVM%20snippet/&title=jvm snippet"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://www.willshirley.top/2018/01/18/JVM%20snippet/&title=jvm snippet"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://www.willshirley.top/2018/01/18/JVM%20snippet/&t=jvm snippet"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#JRE-JVM-JDK"><span class="toc-number">1.</span> <span class="toc-text">JRE JVM JDK</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#basic-architecture-of-the-JVM"><span class="toc-number">2.</span> <span class="toc-text">basic architecture of the JVM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Class-Loader-Sub-System"><span class="toc-number">2.1.</span> <span class="toc-text">Class Loader Sub System</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Loading"><span class="toc-number">2.1.1.</span> <span class="toc-text">1. Loading</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Linking"><span class="toc-number">2.1.2.</span> <span class="toc-text">2. Linking</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Class-loader-sub-system-follows-delegation-hierarchy-algorithm"><span class="toc-number">2.1.3.</span> <span class="toc-text">3. Class loader sub system follows delegation hierarchy algorithm</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Various-Memory-Areas-in-JVM"><span class="toc-number">2.2.</span> <span class="toc-text">Various Memory Areas in JVM</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Method-Area"><span class="toc-number">2.2.1.</span> <span class="toc-text">1. Method Area</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Heap-Area"><span class="toc-number">2.2.2.</span> <span class="toc-text">2. Heap Area</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Stack-Memory"><span class="toc-number">2.2.3.</span> <span class="toc-text">3. Stack Memory</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-PC-Registers-Program-Counter-Registers"><span class="toc-number">2.2.4.</span> <span class="toc-text">4. PC Registers(Program Counter Registers)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Native-Method-Stacks"><span class="toc-number">2.2.5.</span> <span class="toc-text">5. Native Method Stacks</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Execution-Engine"><span class="toc-number">2.3.</span> <span class="toc-text">Execution Engine</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Interpreter"><span class="toc-number">2.3.1.</span> <span class="toc-text">1. Interpreter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-JIT-Compiler"><span class="toc-number">2.3.2.</span> <span class="toc-text">2. JIT Compiler</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java-Native-Interface-JNI"><span class="toc-number">2.4.</span> <span class="toc-text">Java Native Interface(JNI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E5%A4%A7%E5%B0%8F%E8%AE%BE%E7%BD%AE"><span class="toc-number">2.5.</span> <span class="toc-text">内存大小设置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E5%86%85%E5%AD%98"><span class="toc-number"></span> <span class="toc-text">进程内存</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B%E5%AF%B9%E8%B1%A1%E5%A4%A7%E5%B0%8F"><span class="toc-number">1.</span> <span class="toc-text">查看进程对象大小</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%86%85%E5%AD%98%E5%88%86%E5%B8%83%E5%8F%8A%E5%9B%9E%E6%94%B6%E6%83%85%E5%86%B5"><span class="toc-number">2.</span> <span class="toc-text">查看内存分布及回收情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%A0%86%E6%A0%88%E5%8D%A0%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">查看堆栈占用</span></a></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        jvm snippet
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">brook</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2018-01-18T14:00:30.000Z" class="dt-published" itemprop="datePublished">2018-01-18</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/java/">java</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/snippet/" rel="tag">snippet</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="JRE-JVM-JDK"><a href="#JRE-JVM-JDK" class="headerlink" title="JRE JVM JDK"></a>JRE JVM JDK</h2><ul>
<li>JRE:    java run-time</li>
</ul>
<blockquote>
<p>Java is every where in browser, in mobile, in TV or in set-top boxes and if you are into Java programming language than you know that Java code which is bundled in JAR (Java archive) file require Java virtual machine JVM to execute it. </p>
</blockquote>
<ul>
<li>JVM:    java virtual machine</li>
</ul>
<blockquote>
<p> Java Virtual Machine is get created when you run a java program using java command e.g. java HelloWorld. JVM is responsible for converting byte code into machine specific code</p>
</blockquote>
<ul>
<li>JDK:    java development kit</li>
</ul>
<blockquote>
<p> JDK is also loosely referred as JRE but its lot more than JRE and it provides all the tools and executable require to compile debug and execute Java Program.</p>
</blockquote>
<h2 id="basic-architecture-of-the-JVM"><a href="#basic-architecture-of-the-JVM" class="headerlink" title="basic architecture of the JVM"></a>basic architecture of the JVM</h2><img src="https://i.imgur.com/yI8u4Hr.jpg" style="width:50%">

<h3 id="Class-Loader-Sub-System"><a href="#Class-Loader-Sub-System" class="headerlink" title="Class Loader Sub System"></a>Class Loader Sub System</h3><h4 id="1-Loading"><a href="#1-Loading" class="headerlink" title="1. Loading"></a>1. Loading</h4><ul>
<li><p>loading the class file and store inside method area</p>
<img src="https://i.imgur.com/57IalMb.png" style="width:50%"></li>
<li><p>Created object is not student object or customer object. It is a predefined class “Class” object that is presently in java.lang package.</p>
<img src="https://i.imgur.com/9hHykjw.png" style="width:70%"></li>
<li><p>For every loaded .class file, only one class “Class” object will be created by JVM, even though we are using that class multiple times in our program. Example,</p>
<img src="https://i.imgur.com/KKpqYVn.png" style="width:70%"></li>
</ul>
<h4 id="2-Linking"><a href="#2-Linking" class="headerlink" title="2. Linking"></a>2. Linking</h4><ul>
<li><p><strong>verification</strong> </p>
<blockquote>
<p>This Byte Code Verifier is responsible to verify weather .class file is properly formatted or not, structurally correct or not, generated by valid compiler or not.</p>
</blockquote>
</li>
<li><p><strong>preparation</strong> </p>
<blockquote>
<p>allocate memory for class level static variables and assigned default values.</p>
<p>E.g. For int —&gt; 0, For double —&gt; 0.0, For boolean —&gt; false</p>
</blockquote>
</li>
<li><p><strong>Resolution</strong></p>
<blockquote>
<p>It is the process of replacing all symbolic references used in our class with original direct references from method area.</p>
</blockquote>
<p><img src="https://i.imgur.com/jTM8BJz.png"></p>
</li>
<li><p><strong>Initialization</strong></p>
</li>
</ul>
<blockquote>
<p>In Initialization activity, for class level static variables assigns original values and static blocks will be executed from top to bottom.</p>
</blockquote>
<ul>
<li>Types of class loaders in class loader subsystem<ul>
<li>Bootstrap class loader/ Primordial class loader</li>
<li>Extension class loader</li>
<li>Application class loader/System class loader</li>
</ul>
</li>
</ul>
<h4 id="3-Class-loader-sub-system-follows-delegation-hierarchy-algorithm"><a href="#3-Class-loader-sub-system-follows-delegation-hierarchy-algorithm" class="headerlink" title="3. Class loader sub system follows delegation hierarchy algorithm"></a>3. Class loader sub system follows delegation hierarchy algorithm</h4><ul>
<li><strong>Customized class loader</strong>Sometimes we may not satisfy with default class loader mechanism then we can go for Customized class loader. For example:</li>
</ul>
<h3 id="Various-Memory-Areas-in-JVM"><a href="#Various-Memory-Areas-in-JVM" class="headerlink" title="Various Memory Areas in JVM"></a>Various Memory Areas in JVM</h3><h4 id="1-Method-Area"><a href="#1-Method-Area" class="headerlink" title="1. Method Area"></a>1. Method Area</h4><ul>
<li><p>Inside method area class level binary data including static variables will be stored</p>
</li>
<li><p>Constant pools of a class will be stored inside method area.</p>
</li>
<li><p>Method area can be accessed by multiple threads simultaneously.</p>
<blockquote>
<p>All threads share the same method area, so access to the method area’s data structures must be designed to be thread-safe. </p>
</blockquote>
</li>
</ul>
<h4 id="2-Heap-Area"><a href="#2-Heap-Area" class="headerlink" title="2. Heap Area"></a>2. Heap Area</h4><blockquote>
<p><strong>Heap space in Java is used for dynamic memory allocation for Java objects and JRE classes at the runtime</strong>. New objects are always created in heap space and the references to this objects are stored in stack memory.</p>
</blockquote>
<p>These objects have global access and can be accessed from anywhere in the application.</p>
<p>This memory model is further broken into smaller parts called generations, these are:</p>
<ol>
<li><strong>Young Generation –</strong> this is where all new objects are allocated and aged. A minor Garbage collection occurs when this fills up</li>
<li><strong>Old or Tenured Generation –</strong> this is where long surviving objects are stored. When objects are stored in the Young Generation, a threshold for the object’s age is set and when that threshold is reached, the object is moved to the old generation</li>
<li><strong>Permanent Generation –</strong> this consists of JVM metadata for the runtime classes and application methods</li>
</ol>
<ul>
<li>It’s accessed via complex memory management techniques that include Young Generation, Old or Tenured Generation, and Permanent Generation</li>
<li>If heap space is full, Java throws <em>java.lang.OutOfMemoryError</em></li>
<li>Access to this memory is relatively slower than stack memory</li>
<li>This memory, in contrast to stack, isn’t automatically deallocated. It needs Garbage Collector to free up unused objects so as to keep the efficiency of the memory usage</li>
<li>Unlike stack, a heap isn’t threadsafe and needs to be guarded by properly synchronizing the code</li>
</ul>
<hr>
<ul>
<li><p>Objects and corresponding instance variables will be stored in the heap area.</p>
</li>
<li><p>Every array in java is object only hence arrays also will be stored in the heap area.</p>
</li>
<li><p>Heap area can be access by multiple threads and hence the data stored in the heap area is not thread safe.</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Set Maximum and Minimum heap size</span><br><span class="line">-Xmx</span><br><span class="line">     To set maximum heap size , i.e., maxMemory</span><br><span class="line">    java -Xmx512m HeapSpaceDemo</span><br><span class="line">     Here mx = maximum size</span><br><span class="line">              512m = 512 MB</span><br><span class="line">              HeapSpaceDemo = Java class name</span><br><span class="line">-Xms</span><br><span class="line">     To set minimum heap size , i.e., total memory </span><br><span class="line">        java -Xms65m HeapSpaceDemo   </span><br><span class="line">      Here ms = minimum size</span><br><span class="line">              65m = 65 MB</span><br><span class="line">              HeapSpaceDemo = Java class name</span><br><span class="line">or, you can set a minimum maximum heap size at a time</span><br><span class="line">java -Xms256m -Xmx1024m HeapSpaceDemo</span><br></pre></td></tr></table></figure>

<h4 id="3-Stack-Memory"><a href="#3-Stack-Memory" class="headerlink" title="3. Stack Memory"></a>3. Stack Memory</h4><blockquote>
<p><strong>Stack Memory in Java is used for static memory allocation and the execution of a thread.</strong> It contains primitive values that are specific to a method and references to objects that are in a heap, referred from the method.</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Access to this memory is in Last-In-First-Out (LIFO) order. Whenever a new method is called, a new block on top of the stack is created which contains values specific to that method, like primitive variables and references to objects.</span><br><span class="line"></span><br><span class="line">When the method finishes execution, it’s corresponding stack frame is flushed, the flow goes back to the calling method and space becomes available for the next method.</span><br></pre></td></tr></table></figure>

<ul>
<li><p>It grows and shrinks as new methods are called and returned respectively</p>
</li>
<li><p>Variables inside stack exist only as long as the method that created them is running</p>
</li>
<li><p>It’s automatically allocated and deallocated when method finishes execution</p>
</li>
<li><p>If this memory is full, Java throws <em>java.lang.StackOverFlowError</em></p>
</li>
<li><p>Access to this memory is fast when compared to heap memory</p>
</li>
<li><p>This memory is threadsafe as each thread operates in its own stack</p>
</li>
</ul>
<hr>
<ul>
<li><p>Local Variable Array</p>
<ul>
<li><p>It contains all parameters and local variables of the method.</p>
</li>
<li><p>the occupied slot </p>
</li>
</ul>
</li>
<li><p>Operand Stack</p>
<ul>
<li><p>JVM uses operand stack as work space.</p>
</li>
<li><p>last-in first-out (LIFO) </p>
</li>
<li><p>how a Java virtual machine would add two local variables that contain ints and store the int result in a third local variable:</p>
</li>
</ul>
</li>
<li><p>Frame Data</p>
</li>
</ul>
<p><strong>Stack Memory vs Heap Space</strong></p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Stack Memory</th>
<th>Heap Space</th>
</tr>
</thead>
<tbody><tr>
<td>Application</td>
<td>Stack is used in parts, one at a time during execution of a thread</td>
<td>The entire application uses Heap space during runtime</td>
</tr>
<tr>
<td>Size</td>
<td>Stack has size limits depending upon OS and is usually smaller then Heap</td>
<td>There is no size limit on Heap</td>
</tr>
<tr>
<td>Storage</td>
<td>Stores only primitive variables and references to objects that are created in Heap Space</td>
<td>All the newly created objects are stored here</td>
</tr>
<tr>
<td>Order</td>
<td>It is accessed using Last-in First-out (LIFO) memory allocation system</td>
<td>This memory is accessed via complex memory management techniques that include Young Generation, Old or Tenured Generation, and Permanent Generation.</td>
</tr>
<tr>
<td>Life</td>
<td>Stack memory only exists as long as the current method is running</td>
<td>Heap space exists as long as the application runs</td>
</tr>
<tr>
<td>Efficiency</td>
<td>Comparatively much faster to allocate when compared to heap</td>
<td>Slower to allocate when compared to stack</td>
</tr>
<tr>
<td>Allocation/Deallocation</td>
<td>This Memory is automatically allocated and deallocated when a method is called and returned respectively</td>
<td>Heap space is allocated when new objects are created and deallocated by Gargabe Collector when they are no longer referenced</td>
</tr>
</tbody></table>
<h4 id="4-PC-Registers-Program-Counter-Registers"><a href="#4-PC-Registers-Program-Counter-Registers" class="headerlink" title="4. PC Registers(Program Counter Registers)"></a>4. PC Registers(Program Counter Registers)</h4><blockquote>
<p>For every thread a separate PC register will be created at the time of thread creation. PC register contains address of current executing instruction. Once instruction execution completes automatically PC register will be incremented to hold address of next instruction. An “address” can be a native pointer or an offset from the beginning of a method’s byte codes.   </p>
</blockquote>
<h4 id="5-Native-Method-Stacks"><a href="#5-Native-Method-Stacks" class="headerlink" title="5. Native Method Stacks"></a>5. Native Method Stacks</h4><blockquote>
<p>Here also for every Thread a separate run time stack will be created. It contains all the native methods used in the application. Native method means methods written in a language other than the Java programming language. In other words, it is a stack used to execute C/C++ codes invoked through JNI (Java Native Interface). According to the language, a C stack or C++ stack is created.</p>
</blockquote>
<h3 id="Execution-Engine"><a href="#Execution-Engine" class="headerlink" title="Execution Engine"></a>Execution Engine</h3><h4 id="1-Interpreter"><a href="#1-Interpreter" class="headerlink" title="1. Interpreter"></a>1. Interpreter</h4><blockquote>
<p>It is responsible to read byte code and interpret into machine code (native code) and execute that machine code line by line. </p>
</blockquote>
<h4 id="2-JIT-Compiler"><a href="#2-JIT-Compiler" class="headerlink" title="2. JIT Compiler"></a>2. JIT Compiler</h4><blockquote>
<p>The JIT compiler has been introduced to compensate for the disadvantages of the interpreter. The main purpose of JIT compiler is to improve the performance. Internally JIT compiler maintains a separate count for every method. Whenever JVM across any method call, first that method will be interpreted normally by the interpreter and JIT compiler increments the corresponding count variable. </p>
</blockquote>
<ul>
<li><strong>Profiler</strong> which is the part of JIT compiler is responsible to identify Hotspot(Repeated Used Methods).</li>
</ul>
<h3 id="Java-Native-Interface-JNI"><a href="#Java-Native-Interface-JNI" class="headerlink" title="Java Native Interface(JNI)"></a>Java Native Interface(JNI)</h3><blockquote>
<p>JNI is acts as a bridge (Mediator) for java method calls and corresponding native libraries. </p>
</blockquote>
<h3 id="内存大小设置"><a href="#内存大小设置" class="headerlink" title="内存大小设置"></a>内存大小设置</h3><ul>
<li>在命令行下用  java -Xmx1200m -XX:Max Perm Size=60m -version 命令来进行测试，然后逐渐的增大XXXX的值，如果执行正常就表示指定的内存大小可用，否则会打印错误信息。<br>最后得到的虚拟机实际分配到的<br>总内存大小=堆内存+非堆内存<br>1200m：为堆内存大小，如果不指定后者参数则有最大数限制，网上很多文章认为这就是JVM内存， -Xmx为设置最大堆内存<br>60m： 为非堆内存大小， -XX: Max PermSize实为 永久域内存，在堆内存之外，属于非堆内存部分，jdk1.5我测了好像默认为62m，即得到非堆部分默认内存）</li>
</ul>
<h1 id="进程内存"><a href="#进程内存" class="headerlink" title="进程内存"></a>进程内存</h1><h2 id="查看进程对象大小"><a href="#查看进程对象大小" class="headerlink" title="查看进程对象大小"></a>查看进程对象大小</h2><ul>
<li><p><strong>jmap -histo 进程id</strong>  </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jmap -histo 123456 | head -n15</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="查看内存分布及回收情况"><a href="#查看内存分布及回收情况" class="headerlink" title="查看内存分布及回收情况"></a>查看内存分布及回收情况</h2><ul>
<li><p><strong>jstat -gc 进程id 毫秒</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jstat -gc 1692 5000</span><br></pre></td></tr></table></figure>

<p>S0C: Young Generation第一个survivor space的内存大小 (kB).<br>S1C: Young Generation第二个survivor space的内存大小 (kB).<br>S0U: Young Generation第一个Survivor space当前已使用的内存大小 (kB).<br>S1U: Young Generation第二个Survivor space当前已经使用的内存大小 (kB).<br>EC: Young Generation中eden space的内存大小 (kB).<br>EU: Young Generation中Eden space当前已使用的内存大小 (kB).<br>OC: Old Generation的内存大小 (kB).<br>OU: Old Generation当前已使用的内存大小 (kB).<br>MC: Permanent Generation的内存大小 (kB)<br>MU: Permanent Generation当前已使用的内存大小 (kB).<br>YGC: 从启动到采样时Young Generation GC的次数<br>YGCT: 从启动到采样时Young Generation GC所用的时间 (s).<br>FGC: 从启动到采样时Old Generation GC的次数.<br>FGCT: 从启动到采样时Old Generation GC所用的时间 (s).<br>GCT: 从启动到采样时GC所用的总时间 (s).</p>
</li>
</ul>
<h2 id="查看堆栈占用"><a href="#查看堆栈占用" class="headerlink" title="查看堆栈占用"></a>查看堆栈占用</h2><ul>
<li><p><strong>jmap -heap 进程id</strong>  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">S0： 新生代中Survivor space 0区已使用空间的百分比</span><br><span class="line">S1： 新生代中Survivor space 1区已使用空间的百分比</span><br><span class="line">E ：新生代已使用空间的百分比 Eden space</span><br><span class="line">O： 老年代已使用空间的百分比（P:  永久带已使用空间的百分比）</span><br><span class="line"></span><br><span class="line">M： 元空间使用百分比</span><br><span class="line">CCS： 压缩类空间利用率为百分比</span><br><span class="line">YGC： YGC次数</span><br><span class="line">YGCT： 年轻一代垃圾收集时间</span><br><span class="line">FGC： FGC次数.</span><br><span class="line">FGCT： 完全垃圾收集时间</span><br><span class="line">GCT： 垃圾回收总时间</span><br></pre></td></tr></table></figure></li>
</ul>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/search/">Search</a></li>
        
          <li><a href="/tags/">Tag</a></li>
        
          <li><a href="/categories/">Category</a></li>
        
          <li><a href="/archives/">Log</a></li>
        
          <li><a href="/about/">About</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#JRE-JVM-JDK"><span class="toc-number">1.</span> <span class="toc-text">JRE JVM JDK</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#basic-architecture-of-the-JVM"><span class="toc-number">2.</span> <span class="toc-text">basic architecture of the JVM</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Class-Loader-Sub-System"><span class="toc-number">2.1.</span> <span class="toc-text">Class Loader Sub System</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Loading"><span class="toc-number">2.1.1.</span> <span class="toc-text">1. Loading</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Linking"><span class="toc-number">2.1.2.</span> <span class="toc-text">2. Linking</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Class-loader-sub-system-follows-delegation-hierarchy-algorithm"><span class="toc-number">2.1.3.</span> <span class="toc-text">3. Class loader sub system follows delegation hierarchy algorithm</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Various-Memory-Areas-in-JVM"><span class="toc-number">2.2.</span> <span class="toc-text">Various Memory Areas in JVM</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Method-Area"><span class="toc-number">2.2.1.</span> <span class="toc-text">1. Method Area</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Heap-Area"><span class="toc-number">2.2.2.</span> <span class="toc-text">2. Heap Area</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-Stack-Memory"><span class="toc-number">2.2.3.</span> <span class="toc-text">3. Stack Memory</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-PC-Registers-Program-Counter-Registers"><span class="toc-number">2.2.4.</span> <span class="toc-text">4. PC Registers(Program Counter Registers)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Native-Method-Stacks"><span class="toc-number">2.2.5.</span> <span class="toc-text">5. Native Method Stacks</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Execution-Engine"><span class="toc-number">2.3.</span> <span class="toc-text">Execution Engine</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Interpreter"><span class="toc-number">2.3.1.</span> <span class="toc-text">1. Interpreter</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-JIT-Compiler"><span class="toc-number">2.3.2.</span> <span class="toc-text">2. JIT Compiler</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java-Native-Interface-JNI"><span class="toc-number">2.4.</span> <span class="toc-text">Java Native Interface(JNI)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E5%A4%A7%E5%B0%8F%E8%AE%BE%E7%BD%AE"><span class="toc-number">2.5.</span> <span class="toc-text">内存大小设置</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E5%86%85%E5%AD%98"><span class="toc-number"></span> <span class="toc-text">进程内存</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B%E5%AF%B9%E8%B1%A1%E5%A4%A7%E5%B0%8F"><span class="toc-number">1.</span> <span class="toc-text">查看进程对象大小</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%86%85%E5%AD%98%E5%88%86%E5%B8%83%E5%8F%8A%E5%9B%9E%E6%94%B6%E6%83%85%E5%86%B5"><span class="toc-number">2.</span> <span class="toc-text">查看内存分布及回收情况</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E5%A0%86%E6%A0%88%E5%8D%A0%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">查看堆栈占用</span></a></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://www.willshirley.top/2018/01/18/JVM%20snippet/&text=jvm snippet"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://www.willshirley.top/2018/01/18/JVM%20snippet/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=jvm snippet&body=Check out this article: https://www.willshirley.top/2018/01/18/JVM%20snippet/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://www.willshirley.top/2018/01/18/JVM%20snippet/&title=jvm snippet"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://www.willshirley.top/2018/01/18/JVM%20snippet/&title=jvm snippet"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://www.willshirley.top/2018/01/18/JVM%20snippet/&title=jvm snippet"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://www.willshirley.top/2018/01/18/JVM%20snippet/&t=jvm snippet"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2025
    brook
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/archives/">Log</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
