<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="source is the essence">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="source is the essence">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="brook">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/page/6/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>source is the essence</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="source is the essence" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">source is the essence</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/12/17/docker%20compose/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="brook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="source is the essence">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/17/docker%20compose/" class="post-title-link" itemprop="url">docker compose</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-12-17 11:21:10 / Modified: 14:52:28" itemprop="dateCreated datePublished" datetime="2021-12-17T11:21:10+08:00">2021-12-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="Docker-File-vs-Docker-Compose"><a href="#Docker-File-vs-Docker-Compose" class="headerlink" title="Docker File vs Docker Compose"></a>Docker File vs Docker Compose</h3><p>DockerfileÂ is whatâ€™s used to create a container image, and a Compose file is whatâ€™s used to deploy an instance of that image as a container.</p>
<blockquote>
<p>Compose æ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨ Docker åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚é€šè¿‡ Composeï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ YML æ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰æœåŠ¡ã€‚ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä» YML æ–‡ä»¶é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚</p>
</blockquote>
<h4 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h4><p>Dockerfile the predecessor of a container image. You build an image from a Dockerfile. A typical Dockerfile contains special build instructions, commands likeÂ <code>RUN</code>,Â <code>ADD</code>,Â <code>COPY</code>,Â <code>ENTRYPOINT</code>, etc.</p>
<h4 id="Compose-file"><a href="#Compose-file" class="headerlink" title="Compose file"></a>Compose file</h4><p>Compose files are used in two types of deployments: in the non-cluster deployment withÂ <code>docker-compose</code>Â and a cluster deployment withÂ <code>docker swarm</code>.</p>
<p>Compose files are used in two types of deployments: in the non-cluster deployment with <code>docker-compose</code> and a cluster deployment with <code>docker swarm</code>.</p>
<p>To distinguish the two types, Iâ€™m going to address the compose file responsible for cluster deployment as stack files. Iâ€™ll talk about stack files in a moment.</p>
<p>Compose files are part of a tool called <code>docker-compose</code>. Itâ€™s a client application to the docker daemon server, kind of like the <code>docker</code> CLI client, but instead of typing the whole <code>run</code> commands every time, with <code>docker-compose</code> you can re-use the same YAML file over and over again, and deploy the same container with the same configuration as you did in the first time.</p>
<p>Itâ€™s more readable, more maintainable, more intuitive. A single compose file can contain multiple container deployment configurations.</p>
<ul>
<li><p>æ‰§è¡Œ<code>docker-compose up</code>ï¼ŒæŠ¥é”™</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Couldnâ€™t connect to Docker daemon at http+docker:<span class="comment">//localhost - is it running?</span></span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­<code>docker-compose.yml</code>ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.7&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">build:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;5000:5000&quot;</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">&quot;redis:alpine&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>è§£å†³ï¼Œä½¿ç”¨sudoæƒé™</p>
<ol>
<li><p>Add user to docker group (if not already added)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo usermod -aG docker $USER</span><br></pre></td></tr></table></figure></li>
<li><p>create a symbolic link to /usr/bin using the following command</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ln -s /usr/local/bin/docker-compose /usr/bin/docker-compose</span><br></pre></td></tr></table></figure></li>
<li><p>Restart docker service</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service docker restart</span><br></pre></td></tr></table></figure></li>
<li><p>execute</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker-compose up</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ul>
</li>
</ul>
<p>è¿è¡Œdocker compose upæˆ–docker compose up -d(åå°è¿è¡Œ)è¿è¡Œæ‚¨çš„æ•´ä¸ªåº”ç”¨ç¨‹åºã€‚ <code>æ³¨æ„ï¼šæ¯æ¬¡ä¿®æ”¹ä»»ä¸€é…ç½®æ–‡ä»¶åï¼Œéƒ½è¦ä½¿ç”¨ docker-compose up --build é‡æ–°æ„å»º</code></p>
<blockquote>
<p>æœ‰äº†docker-composeï¼Œå½“æˆ‘ä»¬æƒ³å¯åŠ¨å¤šä¸ªæœåŠ¡æ—¶ï¼Œæ— éœ€å†ä¸€ä¸ªä¸€ä¸ªè¿›è¡Œdocker runæ“ä½œï¼Œè€Œåªéœ€è¦ç¼–å†™docker-compose.ymlé…ç½®æ–‡ä»¶ï¼Œå³å¯ä¸€æ¬¡è¿è¡Œä½ çš„å…¨éƒ¨æœåŠ¡ã€‚</p>
</blockquote>
<hr>
<table>
<thead>
<tr>
<th>å±æ€§</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>docker-compose build</td>
<td>(æ„å»ºymlä¸­æŸä¸ªæœåŠ¡çš„é•œåƒ)</td>
</tr>
<tr>
<td>docker-compose ps</td>
<td>(æŸ¥çœ‹å·²ç»å¯åŠ¨çš„æœåŠ¡çŠ¶æ€ï¼‰</td>
</tr>
<tr>
<td>docker-compose kill</td>
<td>(åœæ­¢æŸä¸ªæœåŠ¡ï¼‰</td>
</tr>
<tr>
<td>docker-compose logs</td>
<td>(å¯ä»¥æŸ¥çœ‹æŸä¸ªæœåŠ¡çš„logï¼‰</td>
</tr>
<tr>
<td>docker-compose port</td>
<td>(æ‰“å°ç»‘å®šçš„public portï¼‰</td>
</tr>
<tr>
<td>docker-compose pull</td>
<td>(pullæœåŠ¡é•œåƒ)</td>
</tr>
<tr>
<td>docker-compose up</td>
<td>(å¯åŠ¨ymlå®šä¹‰çš„æ‰€æœ‰æœåŠ¡ï¼‰</td>
</tr>
<tr>
<td>docker-compose stop</td>
<td>(åœæ­¢ymlä¸­å®šä¹‰çš„æ‰€æœ‰æœåŠ¡ï¼‰</td>
</tr>
<tr>
<td>docker-compose start</td>
<td>(å¯åŠ¨è¢«åœæ­¢çš„ymlä¸­çš„æ‰€æœ‰æœåŠ¡ï¼‰</td>
</tr>
<tr>
<td>docker-compose kill</td>
<td>(å¼ºè¡Œåœæ­¢ymlä¸­å®šä¹‰çš„æ‰€æœ‰æœåŠ¡ï¼‰</td>
</tr>
<tr>
<td>docker-compose rm</td>
<td>ï¼ˆåˆ é™¤ymlä¸­å®šä¹‰çš„æ‰€æœ‰æœåŠ¡ï¼‰</td>
</tr>
<tr>
<td>docker-compose restart</td>
<td>(é‡å¯ymlä¸­å®šä¹‰çš„æ‰€æœ‰æœåŠ¡ï¼‰</td>
</tr>
<tr>
<td>docker-compose scale</td>
<td>(æ‰©å±•æŸä¸ªæœåŠ¡çš„ä¸ªæ•°ï¼Œå¯ä»¥å‘ä¸Šæˆ–å‘ä¸‹ï¼‰</td>
</tr>
<tr>
<td>docker-compose version</td>
<td>ï¼ˆæŸ¥çœ‹composeçš„ç‰ˆæœ¬ï¼‰</td>
</tr>
</tbody></table>
<p>æ—¥å¿—è¾“å‡º  </p>
<p>ç»ˆç«¯è¾“å‡ºï¼š<code>docker-compose --verbose up $service_name</code></p>
<p>æˆ–è€…docker-compose.ymlé…ç½®</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stdin_open: true</span><br><span class="line">tty: true</span><br></pre></td></tr></table></figure>





<h3 id="é•œåƒé‡æ–°ç¼–è¯‘"><a href="#é•œåƒé‡æ–°ç¼–è¯‘" class="headerlink" title="é•œåƒé‡æ–°ç¼–è¯‘"></a>é•œåƒé‡æ–°ç¼–è¯‘</h3><p>å¦‚æœä¿®æ”¹äº† Dockerfileå†…å®¹é‡Œé¢ç›¸å…³çš„ä¿¡æ¯ï¼Œéœ€è¦é‡æ–°ç¼–è¯‘é•œåƒï¼Œå¦‚æœä½¿ç”¨docker composeï¼Œåˆ™éœ€è¦ä½¿ç”¨å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up --build</span><br></pre></td></tr></table></figure>



<h3 id="åå°è¿è¡Œ"><a href="#åå°è¿è¡Œ" class="headerlink" title="åå°è¿è¡Œ"></a>åå°è¿è¡Œ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/12/17/dockerFile/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="brook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="source is the essence">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/17/dockerFile/" class="post-title-link" itemprop="url">dockerFile</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-12-17 11:20:31 / Modified: 11:20:35" itemprop="dateCreated datePublished" datetime="2021-12-17T11:20:31+08:00">2021-12-17</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ul>
<li><p><strong>RUN</strong> is executed while the image is being build</p>
<p>while <strong>ENTRYPOINT</strong> is executed after the image has been built.</p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/12/14/docker%20migration/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="brook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="source is the essence">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/14/docker%20migration/" class="post-title-link" itemprop="url">docker migration</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-12-14 14:52:21" itemprop="dateCreated datePublished" datetime="2021-12-14T14:52:21+08:00">2021-12-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-12-16 15:01:56" itemprop="dateModified" datetime="2021-12-16T15:01:56+08:00">2021-12-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>reference </p>
<p><a target="_blank" rel="noopener" href="https://bobcares.com/blog/move-docker-container-to-another-host/">5 ways to move Docker container to another host</a></p>
<p><a target="_blank" rel="noopener" href="https://morioh.com/p/d8d9e7732952">Build a Docker Image with MySQL Database</a></p>
<h2 id="Plan-A"><a href="#Plan-A" class="headerlink" title="Plan A"></a>Plan A</h2><h3 id="Step1-create-an-Image-From-a-Container"><a href="#Step1-create-an-Image-From-a-Container" class="headerlink" title="Step1    create an Image From a Container"></a>Step1    create an Image From a Container</h3><blockquote>
<p>Create a new image from a containerâ€™s changes</p>
<p><a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/commandline/commit/">commit command</a></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker commit [OPTIONS] CONTAINER [REPOSITORY[:TAG]]</span><br></pre></td></tr></table></figure>

<ul>
<li><p>options</p>
<table>
<thead>
<tr>
<th>Name, shorthand</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>--author</code> , <code>-a</code></td>
<td></td>
<td>Author (e.g., â€œwill brookâ€)</td>
</tr>
<tr>
<td><code>--change</code> , <code>-c</code></td>
<td></td>
<td>Apply Dockerfile instruction to the created image</td>
</tr>
<tr>
<td><code>--message</code> , <code>-m</code></td>
<td></td>
<td>Commit message</td>
</tr>
<tr>
<td><code>--pause</code> , <code>-p</code></td>
<td><code>true</code></td>
<td>Pause container during commit</td>
</tr>
</tbody></table>
</li>
</ul>
<h3 id="Step-2-export-the-image-to-a-file"><a href="#Step-2-export-the-image-to-a-file" class="headerlink" title="Step 2    export the image to a file"></a>Step 2    export the image to a file</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker save -o /path/to/your_image.tar your_image_name</span><br></pre></td></tr></table></figure>



<h3 id="Step-3-load-the-Docker-image-file"><a href="#Step-3-load-the-Docker-image-file" class="headerlink" title="Step 3 load the Docker image file"></a>Step 3 load the Docker image file</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker load -i your_image.tar</span><br></pre></td></tr></table></figure>





<hr>
<h2 id="Plan-B"><a href="#Plan-B" class="headerlink" title="Plan B"></a>Plan B</h2><h3 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1"></a>Step 1</h3><p>First save the new image by finding the container ID (usingÂ <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/reference/commandline/ps/"><code>docker container ls</code></a>) and then committing it to a new image name. Note that onlyÂ <code>a-z0-9-_.</code>Â are allowed when naming images:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> create image from container</span></span><br><span class="line">docker container commit c16378f943fe rhel-httpd:latest</span><br></pre></td></tr></table></figure>

<h3 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2"></a>Step 2</h3><p> tag the image with the host name or IP address, and the port of the registry:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> re-tag repository:tag info about image</span></span><br><span class="line">docker image tag rhel-httpd:latest registry-host:5000/myadmin/rhel-httpd:latest</span><br><span class="line">or</span><br><span class="line">docker tag 0e5574283393 registry-host:5000/myadmin/rhel-httpd:latest</span><br></pre></td></tr></table></figure>

<h3 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3"></a>Step 3</h3><p>log in from Docker client:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker login &lt;harbor_address&gt;</span><br></pre></td></tr></table></figure>

<h3 id="Step-4"><a href="#Step-4" class="headerlink" title="Step 4"></a>Step 4</h3><p>push the image to the registry using the image ID. </p>
<p>In this example the registry is on host namedÂ <code>registry-host</code>Â and listening on portÂ <code>5000</code>. (harboré»˜è®¤é…ç½®ç«¯å£80ï¼Œè¯¦è§harbor.yml)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> push repository:tag,</span></span><br><span class="line">docker image push registry-host:5000/myadmin/rhel-httpd:latest</span><br><span class="line">or</span><br><span class="line">docker push registry-host:5000/myname/myimage</span><br></pre></td></tr></table></figure>





<h2 id="Pull-Image-from-Harbor"><a href="#Pull-Image-from-Harbor" class="headerlink" title="Pull Image from Harbor"></a>Pull Image from Harbor</h2><p><a target="_blank" rel="noopener" href="https://goharbor.io/docs/2.0.0/install-config/run-installer-script/#connect-http">Connecting to Harbor via HTTP</a></p>
<h3 id="Step-1-1"><a href="#Step-1-1" class="headerlink" title="Step 1"></a>Step 1</h3><p>add the optionÂ <code>--insecure-registry</code>Â to your clientâ€™s Docker daemon. By default, the daemon file is located atÂ <code>/etc/docker/daemon.json</code>.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">&quot;insecure-registries&quot; : [&quot;ip:port&quot;, &quot;0.0.0.0&quot;] #å¦‚æœportä¸º80ï¼Œåˆ™å¯çœç•¥</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Restart Docker Engine.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure>

<h3 id="Step-2-1"><a href="#Step-2-1" class="headerlink" title="Step 2"></a>Step 2</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull hostAddress/library/REPOSITORY:TAG</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/12/13/docker%20container/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="brook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="source is the essence">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/13/docker%20container/" class="post-title-link" itemprop="url">docker container</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-12-13 18:07:46" itemprop="dateCreated datePublished" datetime="2021-12-13T18:07:46+08:00">2021-12-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-01-07 14:02:27" itemprop="dateModified" datetime="2022-01-07T14:02:27+08:00">2022-01-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/docker/" itemprop="url" rel="index"><span itemprop="name">docker</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="å®¹å™¨"><a href="#å®¹å™¨" class="headerlink" title="å®¹å™¨"></a>å®¹å™¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹æ­£åœ¨è¿è¡Œ</span><br><span class="line">docker ps</span><br><span class="line">æŸ¥çœ‹æ‰€æœ‰</span><br><span class="line">docker ps -a</span><br><span class="line">å¯åŠ¨</span><br><span class="line">docker start å®¹å™¨åæˆ–å®¹å™¨id</span><br><span class="line">ç»ˆæ­¢</span><br><span class="line">docker stop [NAME]/[CONTAINER ID]:å°†å®¹å™¨é€€å‡ºã€‚</span><br><span class="line">docker kill [NAME]/[CONTAINER ID]:å¼ºåˆ¶åœæ­¢ä¸€ä¸ªå®¹å™¨ã€‚</span><br><span class="line"></span><br><span class="line">æŸ¥çœ‹å®¹å™¨ç«¯å£</span><br><span class="line">docker port å®¹å™¨åæˆ–å®¹å™¨id</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">åˆ é™¤</span><br><span class="line">docker rm -f å®¹å™¨id</span><br><span class="line">å¯¼å‡º</span><br><span class="line">docker export å®¹å™¨id &gt; xxx.tar</span><br><span class="line">å¯¼å…¥</span><br><span class="line">docker import - test/xxx:v1</span><br><span class="line">é‡å¯</span><br><span class="line">docker restart $container_id</span><br><span class="line">æ—¥å¿—</span><br><span class="line">docker logs $container_id</span><br></pre></td></tr></table></figure>

<h3 id="æŸ¥çœ‹containerç°åœ¨å·¥ä½œç½‘ç»œæ¨¡å¼"><a href="#æŸ¥çœ‹containerç°åœ¨å·¥ä½œç½‘ç»œæ¨¡å¼" class="headerlink" title="æŸ¥çœ‹containerç°åœ¨å·¥ä½œç½‘ç»œæ¨¡å¼"></a>æŸ¥çœ‹containerç°åœ¨å·¥ä½œç½‘ç»œæ¨¡å¼</h3><ul>
<li><p>åˆ—å‡ºdockerçš„æ‰€æœ‰ç½‘ç»œæ¨¡å¼</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker network ls</span><br></pre></td></tr></table></figure></li>
<li><p>é’ˆå¯¹bridgeå’Œhoståˆ†åˆ«æŸ¥æ‰¾æœ‰å“ªäº›containeråœ¨å…¶ä¸­</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker network inspect bridge</span><br><span class="line">docker network inspect host</span><br></pre></td></tr></table></figure></li>
<li><p>ç›´æ¥æŸ¥çœ‹containerçš„ä¿¡æ¯ï¼Œæ‰¾åˆ°networkæ®µæŸ¥çœ‹ã€‚æˆ–è€…ç”¨grepç­›é€‰å‡ºnetworkã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker inspect å®¹å™¨å/å®¹å™¨ID</span><br><span class="line">docker inspect å®¹å™¨å/å®¹å™¨ID | grep -i â€œnetworkâ€ # å…¶ä¸­grepçš„â€œ-iâ€è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ã€‚</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Exit-Codes"><a href="#Exit-Codes" class="headerlink" title="Exit Codes"></a>Exit Codes</h4><p>Common exit codes associated with docker containers are:</p>
<ul>
<li><p><strong>Exit Code 0</strong>: Absence of an attached foreground process</p>
</li>
<li><p><strong>Exit Code 1</strong>: Indicates failure due to application error</p>
</li>
<li><p><strong>Exit Code 137</strong>: Indicates failure as container received SIGKILL (Manual intervention or â€˜oom-killerâ€™ [OUT-OF-MEMORY])</p>
</li>
<li><p><strong>Exit Code 139</strong>: Indicates failure as container received SIGSEGV</p>
</li>
<li><p><strong>Exit Code 143</strong>: Indicates failure as container received SIGTERM</p>
</li>
<li><p><strong>Exit Code 126</strong>: Permission problem or command is not executable</p>
</li>
<li><p><strong>Exit Code 127</strong>: Possible typos in shell script with unrecognizable characters</p>
</li>
</ul>
<h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><ul>
<li><p>å¯†ç 123456</p>
</li>
<li><p>åˆ›å»ºå®¹å™¨</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker run --name mysql-server -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7</span><br><span class="line">æ³¨æ„ï¼š</span><br><span class="line">-d:è®©å®¹å™¨åœ¨åå°è¿è¡Œ</span><br><span class="line">-P(å¤§å†™):æ˜¯å®¹å™¨å†…éƒ¨ç«¯å£éšæœºæ˜ å°„åˆ°ä¸»æœºçš„é«˜ç«¯å£</span><br><span class="line">-p(å°å†™):æ˜¯å®¹å™¨å†…éƒ¨ç«¯å£ç»‘å®šåˆ°æŒ‡å®šçš„ä¸»æœºç«¯å£</span><br></pre></td></tr></table></figure></li>
<li><p>è¿›å…¥å®¹å™¨</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it mysql-server /bin/bash</span><br></pre></td></tr></table></figure></li>
<li><p>è®¿é—®</p>
<p><code>docker exec -it mysql-server mysql -uroot -p</code></p>
</li>
<li><p>ä¿®æ”¹root å¯ä»¥é€šè¿‡ä»»ä½•å®¢æˆ·ç«¯è¿æ¥</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;123456&#x27;;</span><br></pre></td></tr></table></figure></li>
<li><p>ä»å¤–éƒ¨è®¿é—®docker mysql-server</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -h127.0.0.1 -P3306 -uroot -p</span><br></pre></td></tr></table></figure></li>
<li><p>å¯¼å…¥sqlæ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">å…ˆå°†æ–‡ä»¶å¯¼å…¥åˆ°å®¹å™¨</span><br><span class="line">#docker cp **.sql å®¹å™¨å:/root/</span><br><span class="line">è¿›å…¥å®¹å™¨</span><br><span class="line">#docker exec -ti å®¹å™¨åæˆ–ID sh</span><br><span class="line">ç™»å½•æ•°æ®åº“</span><br><span class="line"># mysql -uroot -p </span><br><span class="line">å°†æ–‡ä»¶å¯¼å…¥æ•°æ®åº“</span><br><span class="line">source æ•°æ®åº“å &lt; /root/***.sql</span><br></pre></td></tr></table></figure></li>
<li><p>å¯¼å‡ºæ•°æ®åº“</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it  mysql-serverï¼ˆå®¹å™¨åï¼‰ mysqldump -uroot -p123456 æ•°æ®åº“åç§° &gt; /opt/sql_bak/test_db.sqlï¼ˆå¯¼å‡ºè¡¨æ ¼è·¯å¾„ï¼‰</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="portainer"><a href="#portainer" class="headerlink" title="portainer"></a>portainer</h3><ul>
<li><p>å¯†ç é‡ç½®</p>
<ul>
<li><p>ä¸‹è½½å¸®åŠ©é•œåƒportainer/helper-reset-password</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull portainer/helper-reset-password</span><br></pre></td></tr></table></figure></li>
<li><p>åœæ­¢è¿è¡Œçš„portainer</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop &quot;id-portainer-container&quot;</span><br></pre></td></tr></table></figure></li>
<li><p>è¿è¡Œé‡ç½®å‘½ä»¤</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --rm -v portainer_data:/data portainer/helper-reset-password</span><br></pre></td></tr></table></figure></li>
<li><p>ç»“æœ</p>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2020</span>/<span class="number">06</span>/<span class="number">04</span> <span class="number">00</span>:<span class="number">13</span>:<span class="number">58</span> Password successfully updated <span class="keyword">for</span> user: admin</span><br><span class="line"><span class="number">2020</span>/<span class="number">06</span>/<span class="number">04</span> <span class="number">00</span>:<span class="number">13</span>:<span class="number">58</span> Use the following password to login: &amp;<span class="number">_4</span>#\<span class="number">3</span>^<span class="number">5</span>V8vLTd)E<span class="string">&quot;NWiJBs26G*9HPl1</span></span><br></pre></td></tr></table></figure></li>
<li><p>é‡æ–°è¿è¡Œportainer,å¯†ç  ä¸ºğŸ‘†é‡ç½®çš„ &amp;_4#\3^5V8vLTd)Eâ€NWiJBs26G*9HPl1</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start &quot;id-portainer-container&quot;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>ç°åœ¨å¯†ç ä¸º admin/admin</p>
</li>
<li><p>é‡æ–°å®‰è£…</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run -d -p 8000:8000 -p 9443:9443 --name portainer \</span><br><span class="line">    --restart=always \</span><br><span class="line">    -v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">    -v portainer_data:/data \</span><br><span class="line">    cr.portainer.io/portainer/portainer-ce:2.9.3</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="nacos"><a href="#nacos" class="headerlink" title="nacos"></a>nacos</h3><ul>
<li>run<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name nacos -p 8848:8848 -e PREFER_HOST_MODE=hostname -e MODE=standalone nacos/nacos-server</span><br></pre></td></tr></table></figure>

<ul>
<li>Linux memory is insufficient<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -e JVM_XMS=256m -e JVM_XMX=256m --env MODE=standalone --name nacos -d -p 8848:8848 nacos/nacos-server</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h3 id="redis"><a href="#redis" class="headerlink" title="redis"></a>redis</h3><blockquote>
<p>ä½¿ç”¨docker-compose up rediså¯åŠ¨å®¹å™¨æ—¶ï¼Œå¦‚æœé…ç½®è‡ªå®šä¹‰é…ç½®æ–‡ä»¶ redis.confï¼Œéœ€è¦è®¾ç½®</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bind 0.0.0.0</span><br><span class="line">daemonize no</span><br></pre></td></tr></table></figure>

<blockquote>
<p>docker-compose.ymlæ–‡ä»¶å†…å®¹</p>
</blockquote>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.7&quot;</span>                                                                            <span class="attr">services:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">&quot;redis:alpine&quot;</span></span><br><span class="line">    <span class="attr">stdin_open:</span> <span class="literal">true</span> <span class="comment">#æ‰“å¼€æ ‡å‡†è¾“å…¥ï¼Œå¯ä»¥æ¥å—å¤–éƒ¨è¾“å…¥ã€‚</span></span><br><span class="line">    <span class="attr">tty:</span> <span class="literal">true</span>  <span class="comment">#æ¨¡æ‹Ÿä¸€ä¸ªä¼ªç»ˆç«¯ã€‚</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/docker/projects/test/redis.conf:/data/redis.conf</span> <span class="comment"># ä¸»æœºè·¯å¾„:å®¹å™¨è·¯å¾„</span></span><br><span class="line">    <span class="comment">#   - /docker/projects/test/redis/data:/data</span></span><br><span class="line">    <span class="comment">#   - /docker/projects/test/redis/logs:/logs</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">redis-server</span> <span class="string">--include</span> <span class="string">/data/redis.conf</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä½¿ç”¨ docker-compose â€“verbose up rediså¯åŠ¨ï¼Œå¯æŸ¥çœ‹å¯åŠ¨è¯¦æƒ…</p>
</blockquote>
<h3 id="ä¿®æ”¹å·²æœ‰å®¹å™¨çš„ç«¯å£æ˜ å°„"><a href="#ä¿®æ”¹å·²æœ‰å®¹å™¨çš„ç«¯å£æ˜ å°„" class="headerlink" title="ä¿®æ”¹å·²æœ‰å®¹å™¨çš„ç«¯å£æ˜ å°„"></a>ä¿®æ”¹å·²æœ‰å®¹å™¨çš„ç«¯å£æ˜ å°„</h3><ol>
<li><p>åœæ­¢å®¹å™¨ </p>
</li>
<li><p>åœæ­¢dockeræœåŠ¡(systemctl stop docker) </p>
</li>
<li><p>ä¿®æ”¹è¿™ä¸ªå®¹å™¨çš„hostconfig.jsonæ–‡ä»¶ä¸­çš„ç«¯å£ï¼ˆåŸå¸–æœ‰äººæåˆ°ï¼Œå¦‚æœconfig.v2.jsoné‡Œé¢ä¹Ÿè®°å½•äº†ç«¯å£ï¼Œä¹Ÿè¦ä¿®æ”¹ï¼‰</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd /var/lib/docker/3b6ef264a040* #è¿™é‡Œæ˜¯CONTAINER ID</span><br><span class="line">vi hostconfig.json</span><br><span class="line">å¦‚æœä¹‹å‰æ²¡æœ‰ç«¯å£æ˜ å°„, åº”è¯¥æœ‰è¿™æ ·çš„ä¸€æ®µ:</span><br><span class="line">&quot;PortBindings&quot;:&#123;&#125;</span><br><span class="line">å¢åŠ ä¸€ä¸ªæ˜ å°„, è¿™æ ·å†™:</span><br><span class="line">&quot;PortBindings&quot;:&#123;&quot;3306/tcp&quot;:[&#123;&quot;HostIp&quot;:&quot;&quot;,&quot;HostPort&quot;:&quot;3307&quot;&#125;]&#125;</span><br><span class="line">å‰ä¸€ä¸ªæ•°å­—æ˜¯å®¹å™¨ç«¯å£, åä¸€ä¸ªæ˜¯å®¿ä¸»æœºç«¯å£. </span><br><span class="line">è€Œä¿®æ”¹ç°æœ‰ç«¯å£æ˜ å°„æ›´ç®€å•, æŠŠç«¯å£å·æ”¹æ‰å°±è¡Œ.</span><br></pre></td></tr></table></figure></li>
<li><p>å¯åŠ¨dockeræœåŠ¡(systemctl start docker) </p>
</li>
<li><p>å¯åŠ¨å®¹å™¨</p>
</li>
</ol>
<h3 id="é…ç½®å®¹å™¨çš„é•œåƒæºï¼ˆå®‰è£…vimï¼‰"><a href="#é…ç½®å®¹å™¨çš„é•œåƒæºï¼ˆå®‰è£…vimï¼‰" class="headerlink" title="é…ç½®å®¹å™¨çš„é•œåƒæºï¼ˆå®‰è£…vimï¼‰"></a>é…ç½®å®¹å™¨çš„é•œåƒæºï¼ˆå®‰è£…vimï¼‰</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mv /etc/apt/sources.list /etc/apt/sources.list.bak</span><br><span class="line"></span><br><span class="line">echo &quot;deb http://mirrors.163.com/debian/ jessie main non-free contrib&quot; &gt;/etc/apt/sources.list</span><br><span class="line"></span><br><span class="line">echo &quot;deb http://mirrors.163.com/debian/ jessie-proposed-updates main non-free contrib&quot; &gt;&gt;/etc/apt/sources.list</span><br><span class="line"></span><br><span class="line">echo &quot;deb-src http://mirrors.163.com/debian/ jessie main non-free contrib&quot; &gt;&gt;/etc/apt/sources.list</span><br><span class="line"></span><br><span class="line">echo &quot;deb-src http://mirrors.163.com/debian/ jessie-proposed-updates main non-free contrib&quot; &gt;&gt;/etc/apt/sources.list </span><br><span class="line"><span class="meta">#</span><span class="bash">æ›´æ–°å®‰è£…æº</span> </span><br><span class="line">apt-get update </span><br><span class="line"><span class="meta">#</span><span class="bash">å¦‚æœä¸‹è½½è¿‡ç¨‹ä¸­å¡åœ¨[waiting <span class="keyword">for</span> headers] åˆ é™¤/var/cache/apt/archives/ä¸‹çš„æ‰€æœ‰æ–‡ä»¶</span> </span><br><span class="line"><span class="meta">#</span><span class="bash">å®‰è£…vim</span> </span><br><span class="line">apt-get install vim</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/12/11/jconsole%20snippet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="brook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="source is the essence">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/11/jconsole%20snippet/" class="post-title-link" itemprop="url">jconsole snippet</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-12-11 21:05:29" itemprop="dateCreated datePublished" datetime="2021-12-11T21:05:29+08:00">2021-12-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-01-25 00:59:14" itemprop="dateModified" datetime="2022-01-25T00:59:14+08:00">2022-01-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index"><span itemprop="name">java</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="jconsoleé…ç½®è¿œç¨‹ç›‘æ§"><a href="#jconsoleé…ç½®è¿œç¨‹ç›‘æ§" class="headerlink" title="jconsoleé…ç½®è¿œç¨‹ç›‘æ§"></a>jconsoleé…ç½®è¿œç¨‹ç›‘æ§</h3><ul>
<li>è¿œç¨‹jvmè¿›ç¨‹éœ€é…ç½®<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">env.java.opts: </span><br><span class="line">-Dcom.sun.management.jmxremote </span><br><span class="line">-Dcom.sun.management.jmxremote.port=9999</span><br><span class="line">-Dcom.sun.management.jmxremote.authenticate=false </span><br><span class="line">-Dcom.sun.management.jmxremote.ssl=false</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å…¶ä¸­9999ä¸ºæŒ‡å®šç›‘æ§ç«¯å£</p>
</blockquote>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/12/09/ignite%20issue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="brook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="source is the essence">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/09/ignite%20issue/" class="post-title-link" itemprop="url">ignite issue</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-12-09 15:22:02" itemprop="dateCreated datePublished" datetime="2021-12-09T15:22:02+08:00">2021-12-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-09-25 19:00:19" itemprop="dateModified" datetime="2023-09-25T19:00:19+08:00">2023-09-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ignite/" itemprop="url" rel="index"><span itemprop="name">ignite</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="BinaryObjectException-Conflicting-enum-values"><a href="#BinaryObjectException-Conflicting-enum-values" class="headerlink" title="BinaryObjectException: Conflicting enum values"></a>BinaryObjectException: Conflicting enum values</h3><ul>
<li><p>åŸå› </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å­˜å…¥igniteçš„æ•°æ®æ ¼å¼</span><br><span class="line">key: String , value: Map&lt;Enum, BigDecimal&gt;</span><br><span class="line">Enumç±»å‹åŒ…å«</span><br><span class="line">&#123;A,B,C&#125;</span><br><span class="line"></span><br><span class="line">åœ¨ä¹‹åç”±äºä¸šåŠ¡å˜æ›´ï¼Œéœ€è¦æ–°å¢æ–°çš„enumé¡¹ç›®ï¼Œå¹¶æ·»åŠ Dåœ¨Aä¸Bä¹‹é—´</span><br><span class="line">&#123;A,D,B,C&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>åˆ†æ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç”±äºåœ¨æ•°æ®å­˜å…¥igniteä¹‹åï¼Œigniteä¼šä¿å­˜æ•°æ®ç›¸å…³çš„schemaä¿¡æ¯,æ­¤æ—¶åœ¨enumé¡¹ç›®ä¹‹é—´ä¿®æ”¹itemï¼Œä¼šæ‰“ä¹±ä¹‹å‰çš„index</span><br></pre></td></tr></table></figure></li>
<li><p>è§£å†³ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æ–¹æ³•ä¸€ï¼š</span><br><span class="line">æ›´æ”¹enumç±»çš„åç§°ï¼Œä¸å†ä½¿ç”¨åŸæœ‰çš„schemaä¿¡æ¯</span><br><span class="line">æ–¹æ³•äºŒï¼š</span><br><span class="line">enumç±»æ–°å¢é¡¹ç›®æ—¶ï¼Œéœ€è¦åœ¨æœ€åé¢æ·»åŠ ï¼Œé¿å…æ‰“ä¹±å·²æœ‰çš„schemaç´¢å¼•</span><br><span class="line">æ–¹æ³•ä¸‰ï¼ˆæœªéªŒè¯ï¼‰ï¼š</span><br><span class="line">åˆ é™¤ $IGNITE_HOME/work/binary_meta/Nodexé‡Œé¢çš„æ–‡ä»¶</span><br></pre></td></tr></table></figure></li>
<li><p>å®˜æ–¹è¯´æ˜</p>
<blockquote>
<ul>
<li>You cannot change the types of existing fields.</li>
<li>You cannot change the order of enum values or add new constants at the beginning or in the middle of the list of enumâ€™s values. You can add new constants to the end of the list though.</li>
</ul>
</blockquote>
</li>
<li><p><strong>å¤„ç†conflict enum values, éœ€è¦æ¸…é™¤æ•°æ®</strong></p>
</li>
</ul>
<blockquote>
<p>éœ€è¦æ¸…ç† $IGNITE_HOME/work/dbç›®å½•ä¸‹çš„ binary_metaã€marshaller</p>
<p>éœ€è¦éªŒè¯æ˜¯å¦æ¸…ç† storagePathã€walPathã€walArchivePath</p>
</blockquote>
<h3 id="gc"><a href="#gc" class="headerlink" title="gc"></a>gc</h3><p><img src="/images/ignite/gc_collect.png"></p>
<blockquote>
<p>3sè¿›è¡Œgc  (110060-52672)/1024=56.04G</p>
</blockquote>
<p><img src="/images/ignite/gc_2.png"></p>
<blockquote>
<p>17sè¿›è¡Œgc (109952-52658)/1024=55.95G</p>
</blockquote>
<h3 id="IgniteCacheException"><a href="#IgniteCacheException" class="headerlink" title="IgniteCacheException"></a>IgniteCacheException</h3><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ERROR org<span class="variable">.apache</span><span class="variable">.ignite</span><span class="variable">.spi</span><span class="variable">.communication</span><span class="variable">.tcp</span><span class="variable">.TcpCommunicationSpi</span>  [] - Failed to send message to remote node [node=ZookeeperClusterNode [id=<span class="number">1</span>c8a032d-<span class="number">042</span>e-<span class="number">4386</span>-<span class="number">9</span>ce8-<span class="number">2605</span>c0699304, addrs=[<span class="number">17</span><span class="variable">.9</span><span class="variable">.11</span><span class="variable">.11</span>], order=<span class="number">1</span>, loc=false, client=false], msg=GridIoMessage [plc=<span class="number">2</span>, topic=TOPIC_CACHE, topicOrd=<span class="number">8</span>, ordered=false, timeout=<span class="number">0</span>, skipOnTimeout=false, msg=GridNearLockRequest [topVer=AffinityTopologyVersion [topVer=<span class="number">358</span>, minorTopVer=<span class="number">0</span>], miniId=<span class="number">1</span>, dhtVers=GridCacheVersion[] [<span class="literal">null</span>], subjId=a5dbdc1d-e76e-<span class="number">49</span>c2-<span class="number">85</span>d7-ed7f1c7db7bd, taskNameHash=<span class="number">0</span>, createTtl=-<span class="number">1</span>, accessTtl=-<span class="number">1</span>, flags=<span class="number">3</span>, txLbl=<span class="literal">null</span>, filter=<span class="literal">null</span>, <span class="keyword">super</span>=GridDistributedLockRequest [nodeId=a5dbdc1d-e76e-<span class="number">49</span>c2-<span class="number">85</span>d7-ed7f1c7db7bd, nearXidVer=GridCacheVersion [topVer=<span class="number">245500806</span>, order=<span class="number">1638786801426</span>, nodeOrder=<span class="number">336</span>], threadId=<span class="number">11960694</span>, futId=<span class="number">96</span>c1bf42d71-<span class="number">90702925</span>-<span class="number">3</span>ef9-<span class="number">4</span>c70-b7a7-<span class="number">4</span>be2fb6d75ba, timeout=<span class="number">0</span>, isInTx=true, isInvalidate=false, isRead=true, isolation=REPEATABLE_READ, retVals=[true], txSize=<span class="number">0</span>, flags=<span class="number">0</span>, keysCnt=<span class="number">1</span>, <span class="keyword">super</span>=GridDistributedBaseMessage [ver=GridCacheVersion [topVer=<span class="number">245500806</span>, order=<span class="number">1638786801426</span>, nodeOrder=<span class="number">336</span>], committedVers=<span class="literal">null</span>, rolledbackVers=<span class="literal">null</span>, cnt=<span class="number">1</span>, <span class="keyword">super</span>=GridCacheIdMessage [cacheId=-<span class="number">182240380</span>, <span class="keyword">super</span>=GridCacheMessage [msgId=<span class="number">1360862</span>, depInfo=<span class="literal">null</span>, lastAffChangedTopVer=AffinityTopologyVersion [topVer=<span class="number">336</span>, minorTopVer=<span class="number">0</span>], err=<span class="literal">null</span>, skipPrepare=false]]]]]]]</span><br><span class="line"></span><br><span class="line">org<span class="variable">.apache</span><span class="variable">.ignite</span><span class="variable">.IgniteCheckedException</span>: Failed to connect to node due to unrecoverable exception (is node still alive?). Make sure that each ComputeTask <span class="keyword">and</span> cache Transaction has a timeout set in order to prevent parties from waiting <span class="keyword">forever</span> in <span class="keyword">case</span> of network issues [nodeId=d0a258e5-ec1b-<span class="number">4</span>f79-<span class="number">89</span>ad-<span class="number">80</span>c27708f895, addrs=[x/x<span class="variable">.x</span><span class="variable">.x</span><span class="variable">.x</span>:<span class="number">47100</span>], err= <span class="keyword">class</span> org<span class="variable">.apache</span><span class="variable">.ignite</span><span class="variable">.IgniteCheckedException</span>: Remote node does <span class="keyword">not</span> observe current node in topology : d0a258e5-ec1b-<span class="number">4</span>f79-<span class="number">89</span>ad-<span class="number">80</span>c27708f895]</span><br><span class="line"></span><br><span class="line">Caused by: org<span class="variable">.apache</span><span class="variable">.ignite</span><span class="variable">.IgniteCheckedException</span>: Remote node does <span class="keyword">not</span> observe current node in topology : d0a258e5-ec1b-<span class="number">4</span>f79-<span class="number">89</span>ad-<span class="number">80</span>c27708f895</span><br></pre></td></tr></table></figure>

<ul>
<li>gcçš„ç­–ç•¥</li>
<li>ignite clientçš„å¼‚å¸¸æ•è·</li>
<li></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/12/03/elasticstatic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="brook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="source is the essence">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/03/elasticstatic/" class="post-title-link" itemprop="url">Elastic Stack learn</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-12-03 09:26:30" itemprop="dateCreated datePublished" datetime="2021-12-03T09:26:30+08:00">2021-12-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-17 21:14:05" itemprop="dateModified" datetime="2022-05-17T21:14:05+08:00">2022-05-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Elasticsearch/" itemprop="url" rel="index"><span itemprop="name">Elasticsearch</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>ELK</strong></p>
<blockquote>
<p>Elasticsearch æ˜¯ä¸€ä¸ªæœç´¢å’Œåˆ†æå¼•æ“ã€‚Logstash æ˜¯æœåŠ¡å™¨ç«¯æ•°æ®å¤„ç†ç®¡é“ï¼Œèƒ½å¤ŸåŒæ—¶ä»å¤šä¸ªæ¥æºé‡‡é›†æ•°æ®ï¼Œè½¬æ¢æ•°æ®ï¼Œç„¶åå°†æ•°æ®å‘é€åˆ°è¯¸å¦‚ Elasticsearch ç­‰â€œå­˜å‚¨åº“â€ä¸­ã€‚Kibana åˆ™å¯ä»¥è®©ç”¨æˆ·åœ¨ Elasticsearch ä¸­ä½¿ç”¨å›¾å½¢å’Œå›¾è¡¨å¯¹æ•°æ®è¿›è¡Œå¯è§†åŒ–ã€‚</p>
</blockquote>
<p>Elasticsearch is the living heart of what is todayâ€™s the most popular log analytics platform â€” the ELK Stack (Elasticsearch, Logstash and Kibana). Elasticsearchâ€™s role is so central that it has become synonymous with the name of the stack itself.</p>
<p>Elasticsearch behaves like a REST API, so you can use either theÂ <code>POST</code>Â or theÂ <code>PUT</code>Â method to add data to it. You useÂ <code>PUT</code>Â when you know the or want to specify theÂ <code>id</code>Â of the data item, orÂ <code>POST</code>Â if you want Elasticsearch to generate anÂ <code>id</code>Â for the data item:</p>
<h3 id="solution"><a href="#solution" class="headerlink" title="solution"></a>solution</h3><h4 id="max-file-descriptors-4096-for-elasticsearch-process-is-too-low-increase-to-at-least-65535"><a href="#max-file-descriptors-4096-for-elasticsearch-process-is-too-low-increase-to-at-least-65535" class="headerlink" title="max file descriptors [4096] for elasticsearch process is too low, increase to at least [65535]"></a>max file descriptors [4096] for elasticsearch process is too low, increase to at least [65535]</h4><p>If you want to increase the limit shown by <code>ulimit -n</code>, you should:</p>
<ul>
<li><p>Modify <code>/etc/systemd/user.conf</code> and <code>/etc/systemd/system.conf</code> with the following line (this takes care of graphical login):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DefaultLimitNOFILE=65535</span><br></pre></td></tr></table></figure></li>
<li><p>Modify <code>/etc/security/limits.conf</code> with the following lines (this takes care of non-GUI login):</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* hard nofile 65535</span><br><span class="line">* soft nofile 65535</span><br></pre></td></tr></table></figure></li>
<li><p>Reboot your computer for changes to take effect.</p>
</li>
<li><p>check</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ulimit -Hn</span><br><span class="line">ulimit -Sn</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="max-virtual-memory-areas-vm-max-map-count-65530-is-too-low-increase-to-at-least-262144"><a href="#max-virtual-memory-areas-vm-max-map-count-65530-is-too-low-increase-to-at-least-262144" class="headerlink" title="max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]"></a>max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]</h4><ul>
<li><p><code>vim /etc/sysctl.confÂ </code></p>
<p>æ–°å¢<strong>vm.max_map_count=655360</strong></p>
</li>
<li><p><code>sysctl -p</code></p>
</li>
</ul>
<h4 id="the-default-discovery-settings-are-unsuitable-for-production-use-at-least-one-of-discovery-seed-hosts-discovery-seed-providers-cluster-initial-master-nodes-must-be-configured"><a href="#the-default-discovery-settings-are-unsuitable-for-production-use-at-least-one-of-discovery-seed-hosts-discovery-seed-providers-cluster-initial-master-nodes-must-be-configured" class="headerlink" title="the default discovery settings are unsuitable for production use; at least one of [discovery.seed_hosts, discovery.seed_providers, cluster.initial_master_nodes] must be configured"></a>the default discovery settings are unsuitable for production use; at least one of [discovery.seed_hosts, discovery.seed_providers, cluster.initial_master_nodes] must be configured</h4><p>in short, if you are running Elasticsearch locally(single node) or just with a single node on the cloud then just use below config in yourÂ <code>elasticsearch.yml</code>Â to avoid the production check, and to make it work, more info about this config inÂ <a target="_blank" rel="noopener" href="https://stackoverflow.com/a/60426167/4039431">this SO</a>Â answer:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">discovery.type:</span> <span class="string">single-node</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/12/03/encrypt-decrpt/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="brook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="source is the essence">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/03/encrypt-decrpt/" class="post-title-link" itemprop="url">encrypt-decrpt</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-12-03 09:26:30" itemprop="dateCreated datePublished" datetime="2021-12-03T09:26:30+08:00">2021-12-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-04-20 11:04:13" itemprop="dateModified" datetime="2022-04-20T11:04:13+08:00">2022-04-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/encrypt-decrpt/" itemprop="url" rel="index"><span itemprop="name">encrypt-decrpt</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <hr>
<p>reference</p>
<p><a target="_blank" rel="noopener" href="https://opensource.com/article/21/7/linux-age">https://opensource.com/article/21/7/linux-age</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/FiloSottile/age">https://github.com/FiloSottile/age</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/12/02/Kubernetes%20snippet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="brook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="source is the essence">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/02/Kubernetes%20snippet/" class="post-title-link" itemprop="url">Kubernetes learn</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-12-02 16:57:50" itemprop="dateCreated datePublished" datetime="2021-12-02T16:57:50+08:00">2021-12-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-03-07 21:09:14" itemprop="dateModified" datetime="2022-03-07T21:09:14+08:00">2022-03-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Kubernetes is pronouncedÂ <strong>coo-ber-net-ees</strong>, not coo-ber-neats. People also use the shortened version k8s a lot. Please donâ€™t pronounce that one k-eightsâ€”it is still coo-ber-net-ees.</p>
<h3 id="Difference-between-Docker-and-Kubernetes"><a href="#Difference-between-Docker-and-Kubernetes" class="headerlink" title="Difference between Docker and Kubernetes"></a>Difference between Docker and Kubernetes</h3><blockquote>
<p>Docker is a containerization platform, and Kubernetes is a container orchestrator for container platforms like Docker.Â </p>
</blockquote>
<h3 id="Docker-Container-Problems"><a href="#Docker-Container-Problems" class="headerlink" title="Docker Container Problems:"></a>Docker Container Problems:</h3><ul>
<li>How would all of these containers be coordinated and scheduled? </li>
<li>How do you seamlessly upgrade an application without any interruption of service? </li>
<li>How do you monitor the health of an application, know when something goes wrong and seamlessly restart it? </li>
</ul>
<p>When most people talk about â€œKubernetes vs. Docker,â€ what they really mean is â€œKubernetes vs. Docker Swarm.â€Â </p>
<h3 id="Kubernetes-architecture-and-its-components"><a href="#Kubernetes-architecture-and-its-components" class="headerlink" title="Kubernetes architecture and its components"></a>Kubernetes architecture and its components</h3><p>We can break down the components into three main parts.</p>
<ol>
<li>The Control Plane - The Master.</li>
<li>Nodes - Where pods get scheduled.</li>
<li>Pods - Holds containers.</li>
</ol>
<p><img src="./img/kubernetes_cluster.png"></p>
<p>Docker is a platform and tool for building, distributing, and running Docker containers. It offers its own native clustering tool that can be used to orchestrate and schedule containers on machine clusters. Kubernetes is a container orchestration system for Docker containers that is more extensive than Docker Swarm and is meant to coordinate clusters of nodes at scale in production in an efficient manner. It works around the concept of pods, which are scheduling units (and can contain one or more containers) in the Kubernetes ecosystem, and they are distributed among nodes to provide high availability. One can easily run a Docker build on a Kubernetes cluster, but Kubernetes itself is not a complete solution and is meant to include custom plugins.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/12/01/nacos%20snippet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="brook">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="source is the essence">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/12/01/nacos%20snippet/" class="post-title-link" itemprop="url">nacos snippet</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-12-01 15:14:40" itemprop="dateCreated datePublished" datetime="2021-12-01T15:14:40+08:00">2021-12-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-11-13 00:08:05" itemprop="dateModified" datetime="2023-11-13T00:08:05+08:00">2023-11-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring-cloud/" itemprop="url" rel="index"><span itemprop="name">spring cloud</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><ul>
<li>2.xç‰ˆæœ¬å¯åŠ¨ï¼Œéœ€è¦æ·»åŠ  -må±æ€§<code>./startup.sh -m standalone</code></li>
</ul>
<h2 id="å¿ƒè·³æœºåˆ¶"><a href="#å¿ƒè·³æœºåˆ¶" class="headerlink" title="å¿ƒè·³æœºåˆ¶"></a>å¿ƒè·³æœºåˆ¶</h2><h3 id="å¥åº·æ£€æŸ¥"><a href="#å¥åº·æ£€æŸ¥" class="headerlink" title="å¥åº·æ£€æŸ¥"></a>å¥åº·æ£€æŸ¥</h3><p>æœåŠ¡ç«¯æ¥å—åˆ°å®¢æˆ·ç«¯çš„æœåŠ¡æ³¨å†Œè¯·æ±‚åï¼Œåœ¨åˆ›å»ºç©ºçš„Serviceåï¼Œå°±ä¼šå¼€å¯å¥åº·æ£€æŸ¥ä»»åŠ¡</p>
<ul>
<li>åœ¨è¶…è¿‡15ç§’æ²¡æ”¶åˆ°å®¢æˆ·ç«¯å¿ƒè·³æ—¶ï¼Œå°±ä¼šæŠŠæ³¨å†Œè¡¨ä¸­å®ä¾‹çš„å¥åº·çŠ¶æ€æ”¹ä¸ºfalse</li>
<li>è¶…æ—¶30ç§’æ²¡æœ‰æ”¶åˆ°å®¢æˆ·ç«¯å¿ƒè·³æ—¶ï¼Œå°±ä¼šä»æ³¨å†Œè¡¨è¡¨å‰”é™¤è¯¥å®ä¾‹ï¼Œä¼šä½¿ç”¨HTTP DELETEæ–¹å¼è°ƒç”¨/v1/ns/instanceåœ°å€</li>
</ul>
<h2 id="open-API"><a href="#open-API" class="headerlink" title="open API"></a>open API</h2><ul>
<li>è·å–å¿ƒè·³</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">curl -X PUT &#x27;127.0.0.1:8848/nacos/v2/ns/instance/beat&#x27; \</span><br><span class="line">-d &#x27;&#123;</span><br><span class="line">      &quot;namespaceId&quot;: &quot;jarvex_space&quot;,</span><br><span class="line">      &quot;serviceName&quot;: &quot;jarvex-common-group@@entity-server&quot;,</span><br><span class="line">      &quot;ip&quot;: &quot;127.0.0.1&quot;,</span><br><span class="line">      &quot;port&quot;: &quot;5333&quot;</span><br><span class="line">&#125;&#x27;</span><br><span class="line">æˆ–</span><br><span class="line">curl -X PUT &#x27;127.0.0.1:8848/nacos/v2/ns/instance/beat&#x27; \</span><br><span class="line">      -d &#x27;namespaceId=jarvex_space&#x27; \</span><br><span class="line">      -d &#x27;serviceName=jarvex-common-group@@entity-server&#x27; \</span><br><span class="line">      -d &#x27;ip=127.0.0.1&#x27; \</span><br><span class="line">      -d &#x27;port=5333&#x27;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>åˆ›å»ºå‘½ä»¤ç©ºé—´</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -d &#x27;namespaceId=jarvex_space&#x27; \</span><br><span class="line">  -d &#x27;namespaceName=jarvex&#x27; \</span><br><span class="line">  -X POS</span><br></pre></td></tr></table></figure></li>
<li><p>åˆ é™¤æŒä¹…åŒ–å®ä¾‹</p>
</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X DELETE &quot;http://127.0.0.1:8848/nacos/v2/ns/instance?serviceName=jarvex-gateway&amp;ip=192.168.1.148&amp;port=8085&amp;namespaceId=jarvex_space&amp;groupName=jarvex-common-group&amp;ephemeral=false&quot;</span><br></pre></td></tr></table></figure>

<h2 id="åŠ¨æ€é…ç½®"><a href="#åŠ¨æ€é…ç½®" class="headerlink" title="åŠ¨æ€é…ç½®"></a>åŠ¨æ€é…ç½®</h2><h3 id="æ–¹æ¡ˆä¸€-nacos-configé…ç½®ä¸­å¿ƒè·å–"><a href="#æ–¹æ¡ˆä¸€-nacos-configé…ç½®ä¸­å¿ƒè·å–" class="headerlink" title="æ–¹æ¡ˆä¸€: nacos configé…ç½®ä¸­å¿ƒè·å–"></a>æ–¹æ¡ˆä¸€: nacos configé…ç½®ä¸­å¿ƒè·å–</h3><ul>
<li><p>é€šè¿‡é…ç½®nacos configå’Œ controllerè·å–</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">config</span>:<span class="string"></span></span><br><span class="line">  <span class="attr">enabled</span>: <span class="string">true</span></span><br><span class="line">  <span class="meta">server-addr</span>: <span class="string">$&#123;spring.cloud.nacos.server-addr&#125;</span></span><br><span class="line">  <span class="meta">file-extension</span>: <span class="string">yaml</span></span><br><span class="line">  <span class="attr">namespace</span>: <span class="string">public</span></span><br></pre></td></tr></table></figure>

<p>controllerç±»ä½¿ç”¨ @Refreshï¼Œåˆ·æ–°åŠ¨æ€é…ç½®</p>
</li>
</ul>
<h3 id="æ–¹æ¡ˆäºŒï¼šnacos-client-ç›‘å¬æŒ‡å®šé…ç½®æ–‡ä»¶ï¼ˆrecommendedï¼‰"><a href="#æ–¹æ¡ˆäºŒï¼šnacos-client-ç›‘å¬æŒ‡å®šé…ç½®æ–‡ä»¶ï¼ˆrecommendedï¼‰" class="headerlink" title="æ–¹æ¡ˆäºŒï¼šnacos client ç›‘å¬æŒ‡å®šé…ç½®æ–‡ä»¶ï¼ˆrecommendedï¼‰"></a>æ–¹æ¡ˆäºŒï¼šnacos client ç›‘å¬æŒ‡å®šé…ç½®æ–‡ä»¶ï¼ˆrecommendedï¼‰</h3><ul>
<li>ç¼–å†™ç›‘å¬ç±»</li>
<li>æ‰‹åŠ¨åˆ·æ–°é…ç½®</li>
</ul>
<h3 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.lijunyi.xyz/docs/SpringCloud/SpringCloud.html#%E6%95%B4%E4%BD%93%E5%A4%A7%E7%BA%B2%F0%9F%92%A8">https://www.lijunyi.xyz/docs/SpringCloud/SpringCloud.html#%E6%95%B4%E4%BD%93%E5%A4%A7%E7%BA%B2%F0%9F%92%A8</a></li>
<li><a target="_blank" rel="noopener" href="http://47.109.59.205/2023/01/02/SpringCloud%E5%AE%9E%E7%94%A8%E7%AF%8702/#1-Nacos%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86">http://47.109.59.205/2023/01/02/SpringCloud%E5%AE%9E%E7%94%A8%E7%AF%8702/#1-Nacos%E9%85%8D%E7%BD%AE%E7%AE%A1%E7%90%86</a></li>
<li><a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2096938">https://cloud.tencent.com/developer/article/2096938</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/taojietaoge/p/16638226.html">https://www.cnblogs.com/taojietaoge/p/16638226.html</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">brook</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">153</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">83</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">35</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">brook</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  


</body>
</html>
