<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>source is the essence</title>
  
  
  <link href="https://www.willshirley.top/atom.xml" rel="self"/>
  
  <link href="https://www.willshirley.top/"/>
  <updated>2024-08-04T16:40:47.546Z</updated>
  <id>https://www.willshirley.top/</id>
  
  <author>
    <name>brook</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Kubernetes delploy</title>
    <link href="https://www.willshirley.top/2024/08/05/kubernetes%20deploy/"/>
    <id>https://www.willshirley.top/2024/08/05/kubernetes%20deploy/</id>
    <published>2024-08-04T16:37:47.000Z</published>
    <updated>2024-08-04T16:40:47.546Z</updated>
    
    <content type="html"><![CDATA[<h1 id="k8s-deploy"><a href="#k8s-deploy" class="headerlink" title="k8s deploy"></a>k8s deploy</h1><h2 id="install-kubelet-kubeadm-kubectl"><a href="#install-kubelet-kubeadm-kubectl" class="headerlink" title="install kubelet kubeadm kubectl"></a>install kubelet kubeadm kubectl</h2><ul><li>Step1</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Set SELinux <span class="keyword">in</span> permissive mode (effectively disabling it)</span></span><br><span class="line">sudo setenforce 0</span><br><span class="line">sudo sed -i &#x27;s/^SELINUX=enforcing$/SELINUX=permissive/&#x27; /etc/selinux/config</span><br></pre></td></tr></table></figure><ul><li>Step2</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo</span><br><span class="line">[kubernetes]</span><br><span class="line">name=Kubernetes</span><br><span class="line">baseurl=https://mirrors.ustc.edu.cn/kubernetes/core:/stable:/v1.30/rpm/</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=https://mirrors.ustc.edu.cn/kubernetes/core:/stable:/v1.30/rpm/repodata/repomd.xml.key</span><br><span class="line">exclude=kubelet kubeadm kubectl cri-tools kubernetes-cni</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><ul><li>step3</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes</span><br><span class="line">sudo systemctl enable --now kubelet</span><br></pre></td></tr></table></figure><h2 id="install-Container-Runtimes"><a href="#install-Container-Runtimes" class="headerlink" title="install Container Runtimes"></a>install Container Runtimes</h2><blockquote><p><a href="https://www.cloudraft.io/blog/container-runtimes">https://www.cloudraft.io/blog/container-runtimes</a></p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RuntimePath to Unix domain socket</span><br><span class="line">containerdunix:///var/run/containerd/containerd.sock</span><br><span class="line">CRI-Ounix:///var/run/crio/crio.sock</span><br><span class="line">Docker Engine (using cri-dockerd)unix:///var/run/cri-dockerd.sock</span><br></pre></td></tr></table></figure><ul><li>Enable ipv4 packet forward</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> sysctl params required by setup, params persist across reboots</span></span><br><span class="line">cat &lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf</span><br><span class="line">net.ipv4.ip_forward = 1</span><br><span class="line">EOF</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Apply sysctl params without reboot</span></span><br><span class="line">sudo sysctl --system</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Verify that net.ipv4.ip_forward is <span class="built_in">set</span> to 1</span></span><br><span class="line">sysctl net.ipv4.ip_forward</span><br></pre></td></tr></table></figure><ul><li>cgroup driver</li></ul><p>To set <code>systemd</code> as the cgroup driver, edit the <a href="https://kubernetes.io/docs/tasks/administer-cluster/kubelet-config-file/"><code>KubeletConfiguration</code></a> option of <code>cgroupDriver</code> and set it to <code>systemd</code>. For example:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">kubelet.config.k8s.io/v1beta1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">KubeletConfiguration</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="attr">cgroupDriver:</span> <span class="string">systemd</span></span><br></pre></td></tr></table></figure><h3 id="containerd"><a href="#containerd" class="headerlink" title="containerd"></a>containerd</h3><ul><li><p>stop docker service (is necessary ?) </p></li><li><p>init config.toml</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo containerd config default | sudo tee /etc/containerd/config.toml</span><br></pre></td></tr></table></figure></li><li><p>config </p></li></ul><p>Configuring the <code>systemd</code> cgroup driver</p><p><code>sudo vim /etc/containerd/config.toml</code></p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#disabled_plugins = [&quot;cri&quot;]</span></span><br><span class="line"><span class="section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.runc]</span></span><br><span class="line">  <span class="section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.runc.options]</span></span><br><span class="line">    <span class="attr">SystemdCgroup</span> = <span class="literal">true</span></span><br><span class="line"><span class="section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;]</span></span><br><span class="line">  <span class="attr">sandbox_image</span> = <span class="string">&quot;registry.cn-hangzhou.aliyuncs.com/google_containers/pause:3.9&quot;</span></span><br><span class="line">  <span class="section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry]</span></span><br><span class="line">    <span class="section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors]</span></span><br><span class="line">      <span class="section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors.&quot;docker.io&quot;]</span></span><br><span class="line">        <span class="attr">endpoint</span>=[<span class="string">&quot;https://registry-1.docker.io&quot;</span>, <span class="string">&quot;https://xxx.mirror.aliyuncs.com&quot;</span>]</span><br><span class="line">      <span class="section">[plugins.&quot;io.containerd.grpc.v1.cri&quot;.registry.mirrors.&quot;registry.k8s.io&quot;]</span></span><br><span class="line">        <span class="attr">endpoint</span>=[<span class="string">&quot;https://xxx.mirror.aliyuncs.com&quot;</span>, <span class="string">&quot;https://k8s.m.daocloud.io&quot;</span>, <span class="string">&quot;https://docker.mirrors.ustc.edu.cn&quot;</span>,<span class="string">&quot;https://hub-mirror.c.163.com&quot;</span>]</span><br></pre></td></tr></table></figure><p><code>sudo systemctl restart containerd</code></p><ul><li><p>check containerd version</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">containerd --version</span><br><span class="line"><span class="meta">#</span><span class="bash"> containerd containerd.io 1.7.19</span> </span><br></pre></td></tr></table></figure></li></ul><h3 id="CRI-O"><a href="#CRI-O" class="headerlink" title="CRI-O"></a>CRI-O</h3><ul><li><p>set repo</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF | sudo tee /etc/yum.repos.d/cri-o.repo</span><br><span class="line">[cri-o]</span><br><span class="line">name=CRI-O</span><br><span class="line">baseurl=https://mirrors.ustc.edu.cn/kubernetes/addons:/cri-o:/stable:/v1.30/rpm/</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=1</span><br><span class="line">gpgkey=https://mirrors.ustc.edu.cn/kubernetes/addons:/cri-o:/stable:/v1.30/rpm/repodata/repomd.xml.key</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure></li><li><p>install</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dnf install -y container-selinux</span><br><span class="line">dnf install -y cri-o</span><br><span class="line">systemctl start crio.service</span><br></pre></td></tr></table></figure></li><li><p>bootstrap cluster</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">swapoff -a</span><br><span class="line">modprobe br_netfilter</span><br><span class="line">sysctl -w net.ipv4.ip_forward=1</span><br><span class="line"></span><br><span class="line">kubeadm init</span><br></pre></td></tr></table></figure></li></ul><h3 id="Docker-Engine"><a href="#Docker-Engine" class="headerlink" title="Docker Engine"></a>Docker Engine</h3><ul><li><p>install docker (existing)</p></li><li><p>install <code>cri-dockerd</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> extract tgz</span></span><br><span class="line">tar -xzvf cri-dockerd-0.3.15.amd64.tgz</span><br><span class="line"></span><br><span class="line">sudo mv ./cri-dockerd /usr/local/bin/</span><br><span class="line">wget https://raw.githubusercontent.com/Mirantis/cri-dockerd/master/packaging/systemd/cri-docker.service</span><br><span class="line">wget https://raw.githubusercontent.com/Mirantis/cri-dockerd/master/packaging/systemd/cri-docker.socket</span><br><span class="line">sudo mv cri-docker.socket cri-docker.service /etc/systemd/system/</span><br><span class="line">sudo sed -i -e &#x27;s,/usr/bin/cri-dockerd,/usr/local/bin/cri-dockerd,&#x27; /etc/systemd/system/cri-docker.service</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">enable</span> service</span></span><br><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl enable cri-docker.service</span><br><span class="line">sudo systemctl enable --now cri-docker.socket</span><br><span class="line">sudo systemctl status cri-docker.socket</span><br></pre></td></tr></table></figure></li></ul><h2 id="config-crictl"><a href="#config-crictl" class="headerlink" title="config crictl"></a>config crictl</h2><ul><li>Config containerd <code>vim /etc/crictl.yaml</code></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">runtime-endpoint:</span> <span class="string">unix:///run/containerd/containerd.sock</span></span><br><span class="line"><span class="attr">image-endpoint:</span> <span class="string">unix:///run/containerd/containerd.sock</span></span><br><span class="line"><span class="attr">timeout:</span> <span class="number">2</span></span><br><span class="line"><span class="attr">debug:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">pull-image-on-create:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><ul><li>verify mirror</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo crictl info</span><br></pre></td></tr></table></figure><h2 id="kubeadm-deploy-cluster"><a href="#kubeadm-deploy-cluster" class="headerlink" title="kubeadm deploy cluster"></a>kubeadm deploy cluster</h2><h3 id="Initializing-control-plane-node"><a href="#Initializing-control-plane-node" class="headerlink" title="Initializing  control-plane node"></a>Initializing  control-plane node</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo kubeadm config images pull --config kubeadm.conf</span><br><span class="line"></span><br><span class="line">sudo kubeadm init --config kubeadm.conf</span><br></pre></td></tr></table></figure><ul><li><p>(optional) resert (back to kubeadm init)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo kubeadm reset --cri-socket unix:///var/run/containerd/containerd.sock</span><br></pre></td></tr></table></figure></li><li><p>Use kubectl</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p $HOME/.kube</span><br><span class="line">sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br></pre></td></tr></table></figure></li><li><p>check the CoreDNS Pod is <code>Running</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods --all-namespaces</span><br><span class="line"></span><br><span class="line">NAMESPACE     NAME                                READY   STATUS    RESTARTS   AGE</span><br><span class="line">kube-system   coredns-7b5944fdcf-mgwq2            1/1     Running   0          4h22m</span><br><span class="line">kube-system   coredns-7b5944fdcf-sxfvt            1/1     Running   0          4h22m</span><br><span class="line">kube-system   etcd-dingo7232                      1/1     Running   1          4h22m</span><br><span class="line">kube-system   kube-apiserver-dingo7232            1/1     Running   1          4h22m</span><br><span class="line">kube-system   kube-controller-manager-dingo7232   1/1     Running   1          4h22m</span><br><span class="line">kube-system   kube-proxy-w2lfk                    1/1     Running   0          4h22m</span><br><span class="line">kube-system   kube-scheduler-dingo7232            1/1     Running   1          4h22m</span><br></pre></td></tr></table></figure></li></ul><h3 id="join-node"><a href="#join-node" class="headerlink" title="join node"></a>join node</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo kubeadm join --token &lt;token&gt; &lt;control-plane-host&gt;:&lt;control-plane-port&gt; --discovery-token-ca-cert-hash sha256:&lt;hash&gt;</span><br></pre></td></tr></table></figure><ul><li>Check on control-plane</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get nodes</span><br></pre></td></tr></table></figure><h3 id="optional"><a href="#optional" class="headerlink" title="optional"></a>optional</h3><ul><li>other node use kubectl</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp root@&lt;control-plane-host&gt;:/etc/kubernetes/admin.conf .</span><br><span class="line">kubectl --kubeconfig ./admin.conf get nodes</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;k8s-deploy&quot;&gt;&lt;a href=&quot;#k8s-deploy&quot; class=&quot;headerlink&quot; title=&quot;k8s deploy&quot;&gt;&lt;/a&gt;k8s deploy&lt;/h1&gt;&lt;h2 id=&quot;install-kubelet-kubeadm-kubectl&quot;&gt;</summary>
      
    
    
    
    <category term="Kubernetes" scheme="https://www.willshirley.top/categories/Kubernetes/"/>
    
    
    <category term="deploy" scheme="https://www.willshirley.top/tags/deploy/"/>
    
  </entry>
  
  <entry>
    <title>shell bash</title>
    <link href="https://www.willshirley.top/2024/07/30/shell%20bash/"/>
    <id>https://www.willshirley.top/2024/07/30/shell%20bash/</id>
    <published>2024-07-30T10:39:34.000Z</published>
    <updated>2024-07-30T10:39:46.249Z</updated>
    
    <content type="html"><![CDATA[<ul><li>the shell assigns its <strong>exit code</strong> to the <code>$?</code> environment variable. The <code>$?</code> variable is how we usually test whether a script has succeeded or not in its execution.</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;the shell assigns its &lt;strong&gt;exit code&lt;/strong&gt; to the &lt;code&gt;$?&lt;/code&gt; environment variable. The &lt;code&gt;$?&lt;/code&gt; variable is how w</summary>
      
    
    
    
    <category term="shell" scheme="https://www.willshirley.top/categories/shell/"/>
    
    
    <category term="bash" scheme="https://www.willshirley.top/tags/bash/"/>
    
  </entry>
  
  <entry>
    <title>GO learn</title>
    <link href="https://www.willshirley.top/2024/07/28/golang%20learn/"/>
    <id>https://www.willshirley.top/2024/07/28/golang%20learn/</id>
    <published>2024-07-28T07:08:28.000Z</published>
    <updated>2024-08-09T08:14:08.169Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Syntax"><a href="#Syntax" class="headerlink" title="Syntax"></a>Syntax</h2><h3 id="sclice"><a href="#sclice" class="headerlink" title="sclice"></a>sclice</h3><ul><li>syntax <code>slice[low:high]</code></li><li>“take from 1 to the end” with <code>numbers[1:]</code>.</li></ul><h3 id="test"><a href="#test" class="headerlink" title="test"></a>test</h3><ul><li><code>go test -v</code></li><li><code>go test -cover</code></li></ul><h3 id="error"><a href="#error" class="headerlink" title="error"></a>error</h3><ul><li> errors are values, so we can refactor it out into a variable and have a single source of truth for it.</li></ul>  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ErrInsufficientFunds = errors.New(<span class="string">&quot;cannot withdraw, insufficient funds&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(w *Wallet)</span> <span class="title">Withdraw</span><span class="params">(amount Bitcoin)</span> <span class="title">error</span></span> &#123;</span><br><span class="line"><span class="keyword">if</span> amount &gt; w.balance &#123;</span><br><span class="line"><span class="keyword">return</span> ErrInsufficientFunds</span><br><span class="line">&#125;</span><br><span class="line">w.balance -= amount</span><br><span class="line"><span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><a href="https://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully">Don’t just check errors, handle them gracefully</a></li></ul><h3 id="pointer"><a href="#pointer" class="headerlink" title="pointer"></a>pointer</h3><blockquote><p><strong>when you call a function or a method the arguments are</strong> <em><strong>copied</strong></em>.</p></blockquote><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//When calling func (w Wallet) Deposit(amount int) the w is a copy of whatever we called the method from.</span></span><br><span class="line"><span class="comment">//*Wallet rather than Wallet which you can read as &quot;a pointer to a wallet</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(w *Wallet)</span> <span class="title">Balance</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line"><span class="keyword">return</span> (*w).balance</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>不可寻址的情况：</li></ul><ol><li><strong>不可变的</strong>值不可寻址。常量、基本类型的值字面量、字符串变量的值、函数以及方法的字面量都是如此。其实这样规定也有安全性方面的考虑。</li><li>绝大多数被视为<strong>临时结果</strong>的值都是不可寻址的。算术操作的结果值属于临时结果，针对值字面量的表达式结果值也属于临时结果。但有一个例外，对切片字面量的索引结果值虽然也属于临时结果，但却是可寻址的。</li><li>若拿到某值的指针可能会破坏程序的一致性，那么就是<strong>不安全的</strong>，该值就不可寻址。由于字典的内部机制，对字典的索引结果值的取址操作都是不安全的。另外，获取由字面量或标识符代表的函数或方法的地址显然也是不安全的。</li></ol><h3 id="assert"><a href="#assert" class="headerlink" title="assert"></a>assert</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">value, ok := <span class="keyword">interface</span>&#123;&#125;(container).(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span>)</span><br></pre></td></tr></table></figure><h3 id="data-type"><a href="#data-type" class="headerlink" title="data type"></a>data type</h3><ul><li>引用类型：切片、字典、通道、函数</li><li>值类型：数组、基础数据类型以及结构体类型</li></ul><h3 id="pointer-1"><a href="#pointer-1" class="headerlink" title="pointer"></a>pointer</h3><ul><li></li></ul><h2 id="tool"><a href="#tool" class="headerlink" title="tool"></a>tool</h2><ul><li><p>errcheck</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">errcheck .</span><br></pre></td></tr></table></figure></li></ul><h2 id="concurrency"><a href="#concurrency" class="headerlink" title="concurrency"></a>concurrency</h2><blockquote><p>Do not communicate by sharing memory; instead, share memory by communicating.</p></blockquote><h3 id="sync"><a href="#sync" class="headerlink" title="sync"></a>sync</h3><ul><li><p><code>Mutex</code> allows us to add locks to our data</p><blockquote><p>mutual exclusion，简称 mutex</p></blockquote></li><li><p><code>WaitGroup</code> is a means of waiting for goroutines to finish jobs</p></li><li><p><code>RWMutex</code> 读写锁</p></li></ul><h2 id="best-practise"><a href="#best-practise" class="headerlink" title="best practise"></a>best practise</h2><h3 id="directory"><a href="#directory" class="headerlink" title="directory"></a>directory</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">project-root/</span><br><span class="line">├── cmd/  # 包含项目的主要应用程序。每个应用程序都有一个单独的子目录。</span><br><span class="line">│   └── myapp/</span><br><span class="line">│       └── main.go  # 主应用程序入口点</span><br><span class="line">├── internal/  # 包含不希望其他项目导入的包</span><br><span class="line">│   ├── app/  # 应用程序的核心逻辑</span><br><span class="line">│   │   └── app.go</span><br><span class="line">│   ├── config/  # 配置相关代码</span><br><span class="line">│   │   └── config.go</span><br><span class="line">│   └── models/  # 数据模型</span><br><span class="line">│       └── user.go</span><br><span class="line">├── pkg/  # 可以被外部应用程序使用的库代码</span><br><span class="line">│   ├── database/  # 数据库操作相关代码</span><br><span class="line">│   │   └── database.go</span><br><span class="line">│   └── utils/  # 通用工具函数</span><br><span class="line">│       └── helper.go</span><br><span class="line">├── api/  # API相关的代码，如果项目提供API</span><br><span class="line">│   └── v1/</span><br><span class="line">│       └── api.go</span><br><span class="line">├── web/  # Web应用相关的文件，如模板和静态资产</span><br><span class="line">│   ├── templates/</span><br><span class="line">│   └── static/</span><br><span class="line">├── scripts/  # 各种工具脚本，如数据库迁移脚本</span><br><span class="line">│   └── migrate.go</span><br><span class="line">├── tests/  # 单元测试和集成测试</span><br><span class="line">│   └── app_test.go</span><br><span class="line">├── docs/  # 项目文档</span><br><span class="line">│   └── README.md</span><br><span class="line">├── go.mod  # Go模块文件</span><br><span class="line">├── go.sum</span><br><span class="line">├── .gitignore</span><br><span class="line">└── README.md</span><br></pre></td></tr></table></figure><h2 id="Paraphrasing"><a href="#Paraphrasing" class="headerlink" title="Paraphrasing"></a>Paraphrasing</h2><ul><li><p>Use channels when passing ownership of data</p></li><li><p>Use mutexes for managing state</p></li><li><p>名称的首字母为大写的程序实体才可以被当前包外的代码引用，否则它就只能被当前包内的其他代码引用。</p></li><li><p>一对不包裹任何东西的花括号，除了可以代表空的代码块之外，还可以用于表示不包含任何内容的数据结构（或者说数据类型）</p></li><li><p>函数类型属于引用类型，它的零值是<code>nil</code>。</p></li><li><p>结构体类型中的一个字段看作是它的一个属性或者一项数据，再把隶属于它的一个方法看作是附加在其中数据之上的一个能力或者一项操作。将属性及其能力（或者说数据及其操作）封装在一起，是面向对象编程（object-oriented programming）的一个主要原则。</p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;Syntax&quot;&gt;&lt;a href=&quot;#Syntax&quot; class=&quot;headerlink&quot; title=&quot;Syntax&quot;&gt;&lt;/a&gt;Syntax&lt;/h2&gt;&lt;h3 id=&quot;sclice&quot;&gt;&lt;a href=&quot;#sclice&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    <category term="GO" scheme="https://www.willshirley.top/categories/GO/"/>
    
    
    <category term="learn" scheme="https://www.willshirley.top/tags/learn/"/>
    
  </entry>
  
  <entry>
    <title>code thought</title>
    <link href="https://www.willshirley.top/2024/07/25/code%20thought/"/>
    <id>https://www.willshirley.top/2024/07/25/code%20thought/</id>
    <published>2024-07-25T07:12:13.000Z</published>
    <updated>2024-08-01T11:33:10.918Z</updated>
    
    <content type="html"><![CDATA[<h2 id="TDD"><a href="#TDD" class="headerlink" title="TDD"></a>TDD</h2><p>TDD, or Test-Driven Development, is a software development process that involves writing automated tests before writing the actual code. In other words, you write the test first, and then you implement the code to make the test pass.</p><p>Here’s how it typically works:</p><ol><li><p><strong>Write a test</strong>: You write an automated test that covers a specific piece of functionality or behavior in your system.</p></li><li><p><strong>Run the test and see it fail</strong>: Since you haven’t implemented the code yet, the test will naturally fail.</p></li><li><p><strong>Write the code</strong>: You then implement the code to make the test pass. This is where you write the actual logic, algorithms, or whatever is needed to satisfy the requirements of the test.</p></li><li><p><strong>Run the test and see it pass</strong>: Now that you’ve written the code, run the test again, and if everything is correct, the test should pass!</p></li><li><p><strong>Refactor the code (if needed)</strong>: If there are any issues with the code or if you can improve the design, you refactor the code to make it more maintainable, efficient, or easier to understand.</p></li></ol><p>The key benefits of TDD include:</p><ol><li><p><strong>Improved code quality</strong>: Writing tests before writing code ensures that your code is robust and meets the requirements.</p></li><li><p><strong>Reduced bugs</strong>: By testing each piece of functionality thoroughly, you can catch errors early on, reducing the overall number of bugs in your system.</p></li><li><p><strong>Faster development</strong>: TDD helps you focus on implementing only what’s necessary to pass the test, making your development process more efficient.</p></li><li><p><strong>Better design</strong>: The process of writing tests and then implementing code encourages good design principles, such as separation of concerns, modularity, and maintainability.</p></li></ol><p>TDD is often used in conjunction with other testing methodologies, like unit testing, integration testing, or acceptance testing, to ensure that your software system is thoroughly tested and reliable.</p><h1 id="idea"><a href="#idea" class="headerlink" title="idea"></a>idea</h1><ul><li><p><a href="http://wiki.c2.com/?MakeItWorkMakeItRightMakeItFast">Make it work, make it right, make it fast</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Where &#x27;work&#x27; is making the tests pass, &#x27;right&#x27; is refactoring the code, and &#x27;fast&#x27; is optimizing the code to make it, for example, run quickly. We can only &#x27;make it fast&#x27; once we&#x27;ve made it work and made it right. We were lucky that the code we were given was already demonstrated to be working, and didn&#x27;t need to be refactored. We should never try to &#x27;make it fast&#x27; before the other two steps have been performed because[Premature optimization is the root of all evil](http://wiki.c2.com/?PrematureOptimization)</span><br></pre></td></tr></table></figure></li><li><p><a href="https://en.wikipedia.org/wiki/If_it_ain't_broke,_don't_fix_it">If it ain’t broke, don’t fix it</a> </p></li><li><p><a href="https://en.wikipedia.org/wiki/KISS_principle">KISS principle</a> </p></li><li><p><a href="https://en.wikipedia.org/wiki/Don't_repeat_yourself">Don’t repeat yourself</a> </p></li><li><p><a href="https://en.wikipedia.org/wiki/Feature_creep">Feature creep</a> </p></li><li><p><a href="https://en.wikipedia.org/wiki/List_of_software_development_philosophies">List of software development philosophies</a> -</p></li><li><p><a href="https://en.wikipedia.org/wiki/Minimum_viable_product">Minimum viable product</a></p></li><li><p><a href="https://en.wikipedia.org/wiki/MoSCoW_method">MoSCoW method</a> </p></li><li><p><a href="https://en.wikipedia.org/wiki/Overengineering">Overengineering</a> </p></li><li><p><a href="https://en.wikipedia.org/wiki/Worse_is_better">Worse is better</a> </p></li><li><p><a href="https://en.wikipedia.org/wiki/SOLID">S.O.L.I.D.</a></p></li><li><p><a href="https://en.wikipedia.org/wiki/Unix_philosophy">Unix philosophy</a></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;TDD&quot;&gt;&lt;a href=&quot;#TDD&quot; class=&quot;headerlink&quot; title=&quot;TDD&quot;&gt;&lt;/a&gt;TDD&lt;/h2&gt;&lt;p&gt;TDD, or Test-Driven Development, is a software development process</summary>
      
    
    
    
    <category term="code" scheme="https://www.willshirley.top/categories/code/"/>
    
    
    <category term="thought" scheme="https://www.willshirley.top/tags/thought/"/>
    
  </entry>
  
  <entry>
    <title>curve</title>
    <link href="https://www.willshirley.top/2024/07/24/curve/"/>
    <id>https://www.willshirley.top/2024/07/24/curve/</id>
    <published>2024-07-24T02:11:19.241Z</published>
    <updated>2024-07-28T07:10:47.090Z</updated>
    
    <content type="html"><![CDATA[<p>TBD</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;TBD&lt;/p&gt;
</summary>
      
    
    
    
    <category term="curve" scheme="https://www.willshirley.top/categories/curve/"/>
    
    
    <category term="learn" scheme="https://www.willshirley.top/tags/learn/"/>
    
  </entry>
  
  <entry>
    <title>python profiler</title>
    <link href="https://www.willshirley.top/2024/07/01/python%20profiler/"/>
    <id>https://www.willshirley.top/2024/07/01/python%20profiler/</id>
    <published>2024-07-01T12:30:45.000Z</published>
    <updated>2024-07-01T12:30:56.654Z</updated>
    
    <content type="html"><![CDATA[<h1 id="py-spy"><a href="#py-spy" class="headerlink" title="py-spy"></a>py-spy</h1><h2 id="record"><a href="#record" class="headerlink" title="record"></a>record</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo py-spy record -o tableagent.svg --pid 37152</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;py-spy&quot;&gt;&lt;a href=&quot;#py-spy&quot; class=&quot;headerlink&quot; title=&quot;py-spy&quot;&gt;&lt;/a&gt;py-spy&lt;/h1&gt;&lt;h2 id=&quot;record&quot;&gt;&lt;a href=&quot;#record&quot; class=&quot;headerlink&quot; titl</summary>
      
    
    
    
    <category term="python" scheme="https://www.willshirley.top/categories/python/"/>
    
    
    <category term="profiler" scheme="https://www.willshirley.top/tags/profiler/"/>
    
  </entry>
  
  <entry>
    <title>jwt points</title>
    <link href="https://www.willshirley.top/2024/06/27/jwt/"/>
    <id>https://www.willshirley.top/2024/06/27/jwt/</id>
    <published>2024-06-27T02:58:13.000Z</published>
    <updated>2024-07-21T04:18:53.510Z</updated>
    
    <content type="html"><![CDATA[<p>JWT 由三个部分组成，用 . 分隔：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJrZXkiOiJ1c2VyLWtleSIsImV4cCI6MTU2NDA1MDgxMX0.Us8zh_4VjJXF-TmR5f8cif8mBU7SuefPlpxhH0jbPVI</span><br></pre></td></tr></table></figure><p>​    1.    Header（头部）：eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</p><p>​    2.    Payload（负载）：eyJrZXkiOiJ1c2VyLWtleSIsImV4cCI6MTU2NDA1MDgxMX0</p><p>​    3.    Signature（签名）：Us8zh_4VjJXF-TmR5f8cif8mBU7SuefPlpxhH0jbPVI</p><ul><li><p><strong>可直接使用 Base64 解码 Header 和 Payload</strong></p></li><li><p><strong>signature验签</strong></p><p>使用 Header里面的算法验证签名需要用到与签名时相同的密钥（公钥）。以下是验证签名的示例代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">verify_signature</span>(<span class="params">header, payload, secret, signature</span>):</span></span><br><span class="line">    message = <span class="string">f&quot;<span class="subst">&#123;header&#125;</span>.<span class="subst">&#123;payload&#125;</span>&quot;</span></span><br><span class="line">    expected_signature = hmac.new(secret.encode(), message.encode(), hashlib.sha256).digest()</span><br><span class="line">    expected_signature_base64 = base64.urlsafe_b64encode(expected_signature).rstrip(<span class="string">b&#x27;=&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> hmac.compare_digest(expected_signature_base64, signature)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例密钥（替换为实际的密钥）</span></span><br><span class="line">secret = <span class="string">&quot;your-256-bit-secret&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证签名</span></span><br><span class="line">is_valid = verify_signature(header, payload, secret, signature)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Signature is valid: <span class="subst">&#123;is_valid&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;JWT 由三个部分组成，用 . 分隔：&lt;/p&gt;
&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;</summary>
      
    
    
    
    <category term="jwt" scheme="https://www.willshirley.top/categories/jwt/"/>
    
    
    <category term="learn" scheme="https://www.willshirley.top/tags/learn/"/>
    
  </entry>
  
  <entry>
    <title>time snippet</title>
    <link href="https://www.willshirley.top/2024/06/12/time/"/>
    <id>https://www.willshirley.top/2024/06/12/time/</id>
    <published>2024-06-12T08:24:54.000Z</published>
    <updated>2024-06-12T08:25:04.803Z</updated>
    
    <content type="html"><![CDATA[<ul><li>GMT（格林尼治标准时间）是格林尼治时间，没有夏令时调整。</li><li>UTC（协调世界时）是国际时间标准，通常与GMT相同，但在某些情况下，UTC可能会有闰秒的调整。</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;GMT（格林尼治标准时间）是格林尼治时间，没有夏令时调整。&lt;/li&gt;
&lt;li&gt;UTC（协调世界时）是国际时间标准，通常与GMT相同，但在某些情况下，UTC可能会有闰秒的调整。&lt;/li&gt;
&lt;/ul&gt;
</summary>
      
    
    
    
    <category term="time" scheme="https://www.willshirley.top/categories/time/"/>
    
    
    <category term="snippet" scheme="https://www.willshirley.top/tags/snippet/"/>
    
  </entry>
  
  <entry>
    <title>casdoor point</title>
    <link href="https://www.willshirley.top/2024/06/05/casdoor/"/>
    <id>https://www.willshirley.top/2024/06/05/casdoor/</id>
    <published>2024-06-05T09:42:30.000Z</published>
    <updated>2024-07-24T06:04:09.675Z</updated>
    
    <content type="html"><![CDATA[<h2 id="deploy"><a href="#deploy" class="headerlink" title="deploy"></a>deploy</h2><ul><li><p>docker</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run -d -p 18000:8000 \</span><br><span class="line">  -v /usr/share/zoneinfo/Asia/Shanghai:/etc/localtime:ro \</span><br><span class="line">  -v /home/dingodb/dongwei/docker/timezone:/etc/timezone:ro \</span><br><span class="line">  casbin/casdoor-all-in-one</span><br></pre></td></tr></table></figure><blockquote><p>容器内部服务端口8000，映射成对外访问接端口 18000</p></blockquote></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;deploy&quot;&gt;&lt;a href=&quot;#deploy&quot; class=&quot;headerlink&quot; title=&quot;deploy&quot;&gt;&lt;/a&gt;deploy&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;docker&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;t</summary>
      
    
    
    
    <category term="casdoor" scheme="https://www.willshirley.top/categories/casdoor/"/>
    
    
    <category term="point" scheme="https://www.willshirley.top/tags/point/"/>
    
  </entry>
  
  <entry>
    <title>oauth2 practise</title>
    <link href="https://www.willshirley.top/2024/05/31/oauth2/"/>
    <id>https://www.willshirley.top/2024/05/31/oauth2/</id>
    <published>2024-05-31T10:04:12.000Z</published>
    <updated>2024-06-02T09:40:33.732Z</updated>
    
    <content type="html"><![CDATA[<h2 id="overview"><a href="#overview" class="headerlink" title="overview"></a>overview</h2><h3 id="OAuth-2-0-terminology"><a href="#OAuth-2-0-terminology" class="headerlink" title="OAuth 2.0 terminology"></a>OAuth 2.0 terminology</h3><ul><li><strong>Resource Owner</strong>: Entity that can grant access to a protected resource. Typically, this is the end-user.</li><li><strong>Client</strong>: Application requesting access to a protected resource on behalf of the Resource Owner.</li><li><strong>Resource Server</strong>: Server hosting the protected resources. This is the API you want to access.</li><li><strong>Authorization Server</strong>: Server that authenticates the Resource Owner and issues Access Tokens after getting proper authorization. In this case, Auth0.</li><li><strong>User Agent</strong>: Agent used by the Resource Owner to interact with the Client (for example, a browser or a native application).</li></ul><p><img src="/images/security/user-journey-oauth.webp" alt="user-journey-oauth"></p><p>The best practice for implementing OAuth2 in a web application with a separate frontend and backend is to use the Backend for Frontend (BFF) pattern. Here’s how it works:</p><p>The frontend (e.g. a Single Page Application) initiates the OAuth2 flow by redirecting the user to the OAuth2 provider’s authorization endpoint. The provider then authenticates the user and redirects back to the frontend with an authorization code.</p><p>The frontend then sends this authorization code to the backend over a secure channel (e.g. HTTPS). The backend acts as a confidential client and exchanges the authorization code with the OAuth2 provider for an access token and refresh token.[1][3]</p><p>The backend stores the tokens securely and returns an opaque session cookie or token to the frontend. This session identifier represents the authenticated user session.[1]</p><p>For subsequent API requests, the frontend includes the session cookie/token. The backend validates the session and retrieves the access token, using it to authenticate the request to the backend API or other third-party APIs on behalf of the user.[1][3]</p><p>This pattern has several advantages:</p><ol><li><p>The access token is never exposed to the frontend, mitigating the risk of token theft.[1][3]</p></li><li><p>The backend can securely store and manage the refresh of access tokens without involving the frontend.[3]</p></li><li><p>The backend can act as a gatekeeper, validating requests and enforcing authorization rules before proxying to third-party APIs.[3]</p></li><li><p>The frontend only needs to handle the initial OAuth2 redirect and session management, simplifying its code.[1]</p></li></ol><p>To implement this, the backend must be registered as a confidential OAuth2 client with the provider. The frontend can use libraries like Auth0 or Google’s client-side libraries to initiate the OAuth2 flow.[1][4] The backend handles the code exchange and token management, often using server-side OAuth2 libraries or middleware.[1]</p><p>Citations:<br>[1] <a href="https://auth0.com/blog/backend-for-frontend-pattern-with-auth0-and-dotnet/">https://auth0.com/blog/backend-for-frontend-pattern-with-auth0-and-dotnet/</a><br>[2] <a href="https://community.qlik.com/t5/New-to-Qlik-Analytics/How-to-Secure-Backend-API-Endpoints-on-the-Front-End-Best/td-p/2423853">https://community.qlik.com/t5/New-to-Qlik-Analytics/How-to-Secure-Backend-API-Endpoints-on-the-Front-End-Best/td-p/2423853</a><br>[3] <a href="https://auth0.com/blog/the-backend-for-frontend-pattern-bff/">https://auth0.com/blog/the-backend-for-frontend-pattern-bff/</a><br>[4] <a href="https://infisical.com/blog/guide-to-implementing-oauth2">https://infisical.com/blog/guide-to-implementing-oauth2</a><br>[5] <a href="https://www.reddit.com/r/node/comments/skmjjn/0auth_implemented_on_frontend_or_backend/">https://www.reddit.com/r/node/comments/skmjjn/0auth_implemented_on_frontend_or_backend/</a></p><hr><p>reference</p><ul><li><a href="https://auth0.com/docs/get-started/authentication-and-authorization-flow/which-oauth-2-0-flow-should-i-use">https://auth0.com/docs/get-started/authentication-and-authorization-flow/which-oauth-2-0-flow-should-i-use</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;overview&quot;&gt;&lt;a href=&quot;#overview&quot; class=&quot;headerlink&quot; title=&quot;overview&quot;&gt;&lt;/a&gt;overview&lt;/h2&gt;&lt;h3 id=&quot;OAuth-2-0-terminology&quot;&gt;&lt;a href=&quot;#OAuth-2-</summary>
      
    
    
    
    <category term="oauth2" scheme="https://www.willshirley.top/categories/oauth2/"/>
    
    
    <category term="pracise" scheme="https://www.willshirley.top/tags/pracise/"/>
    
  </entry>
  
  <entry>
    <title>python pytest</title>
    <link href="https://www.willshirley.top/2024/05/20/python%20pytest/"/>
    <id>https://www.willshirley.top/2024/05/20/python%20pytest/</id>
    <published>2024-05-20T07:21:43.000Z</published>
    <updated>2024-06-03T10:22:44.269Z</updated>
    
    <content type="html"><![CDATA[<h2 id="test"><a href="#test" class="headerlink" title="test"></a>test</h2><ul><li><p>查看测试详情</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest -v</span><br></pre></td></tr></table></figure></li><li><p>测试信息打印</p><blockquote><p>默认情况下，pytest 会捕获所有的输出。这意味着在测试运行期间， <code>print</code> 语句的输出不会显示在控制台上。</p><p>如果想看到 <code>print</code> 语句的输出，需要使用 <code>-s</code> 选项来告诉 pytest 不要捕获输出</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest -s test_web_base.py</span><br></pre></td></tr></table></figure></li><li><p>测试指定方法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest tests/unit_tests/document_loaders/test_web_base.py::类名::方法名</span><br></pre></td></tr></table></figure></li><li><p>测试被标记的方法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@pytest.mark.finished</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_func1</span>():</span></span><br><span class="line">    <span class="keyword">assert</span> <span class="number">1</span> == <span class="number">1</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest -m finished tests/test-function/test_with_mark.py</span><br></pre></td></tr></table></figure></li><li><p>生成测试报告</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pytest --html=report.html</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;test&quot;&gt;&lt;a href=&quot;#test&quot; class=&quot;headerlink&quot; title=&quot;test&quot;&gt;&lt;/a&gt;test&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;查看测试详情&lt;/p&gt;
&lt;figure class=&quot;highlight shell&quot;&gt;&lt;table&gt;&lt;tr</summary>
      
    
    
    
    <category term="python" scheme="https://www.willshirley.top/categories/python/"/>
    
    
    <category term="pytest" scheme="https://www.willshirley.top/tags/pytest/"/>
    
  </entry>
  
  <entry>
    <title>python TBD</title>
    <link href="https://www.willshirley.top/2024/04/15/python%20pkg%20TBD/"/>
    <id>https://www.willshirley.top/2024/04/15/python%20pkg%20TBD/</id>
    <published>2024-04-15T04:02:38.000Z</published>
    <updated>2024-07-24T03:33:57.795Z</updated>
    
    <content type="html"><![CDATA[<ul><li>fire</li><li>networkx</li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;ul&gt;
&lt;li&gt;fire&lt;/li&gt;
&lt;li&gt;networkx&lt;/li&gt;
&lt;/ul&gt;
</summary>
      
    
    
    
    <category term="python" scheme="https://www.willshirley.top/categories/python/"/>
    
    
    <category term="TBD" scheme="https://www.willshirley.top/tags/TBD/"/>
    
  </entry>
  
  <entry>
    <title>github copilot</title>
    <link href="https://www.willshirley.top/2024/03/13/github%20copilot/"/>
    <id>https://www.willshirley.top/2024/03/13/github%20copilot/</id>
    <published>2024-03-13T02:00:52.000Z</published>
    <updated>2024-03-13T03:03:26.175Z</updated>
    
    <content type="html"><![CDATA[<h1 id="keywords"><a href="#keywords" class="headerlink" title="keywords"></a>keywords</h1><ul><li><p>提示内容写入 ➡️</p></li><li><p>下一个提示 <code>option + ]</code>，上一个提示 <code>option + [</code></p></li><li><p>接收一行<code>command + 右方向</code> ，多行 <code>control/fn + command + 右方向</code></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;keywords&quot;&gt;&lt;a href=&quot;#keywords&quot; class=&quot;headerlink&quot; title=&quot;keywords&quot;&gt;&lt;/a&gt;keywords&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;提示内容写入 ➡️&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;下一个提示 &lt;cod</summary>
      
    
    
    
    <category term="github" scheme="https://www.willshirley.top/categories/github/"/>
    
    
    <category term="assistant" scheme="https://www.willshirley.top/tags/assistant/"/>
    
  </entry>
  
  <entry>
    <title>GPU learn</title>
    <link href="https://www.willshirley.top/2024/03/08/GPU%20learn/"/>
    <id>https://www.willshirley.top/2024/03/08/GPU%20learn/</id>
    <published>2024-03-08T02:08:49.000Z</published>
    <updated>2024-03-08T02:28:58.252Z</updated>
    
    <content type="html"><![CDATA[<h1 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h1><ul><li><p>查看卡的数量</p><p><code>nvidia-smi -L</code></p></li><li><p>查看显卡上运行的程序，以及所占内存情况</p><p><code>nvidia-smi --query-compute-apps=pid,process_name,used_memory,gpu_uuid --format=csv</code></p></li><li><p>查看显卡所剩内存</p><p><code>nvidia-smi --query-gpu=memory.free --format=csv,noheader,nounits</code></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;命令&quot;&gt;&lt;a href=&quot;#命令&quot; class=&quot;headerlink&quot; title=&quot;命令&quot;&gt;&lt;/a&gt;命令&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;查看卡的数量&lt;/p&gt;
&lt;p&gt;&lt;code&gt;nvidia-smi -L&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;查看显</summary>
      
    
    
    
    <category term="GPU" scheme="https://www.willshirley.top/categories/GPU/"/>
    
    
    <category term="learn" scheme="https://www.willshirley.top/tags/learn/"/>
    
  </entry>
  
  <entry>
    <title>python pydantic</title>
    <link href="https://www.willshirley.top/2024/03/05/python%20pkg%20pydantic/"/>
    <id>https://www.willshirley.top/2024/03/05/python%20pkg%20pydantic/</id>
    <published>2024-03-05T03:44:46.000Z</published>
    <updated>2024-04-16T06:22:49.151Z</updated>
    
    <content type="html"><![CDATA[<h2 id="model-validator"><a href="#model-validator" class="headerlink" title="model_validator"></a>model_validator</h2><blockquote><p><code>model_validator</code> 是 Pydantic 库提供的一个装饰器，用于定义模型验证器函数。模型验证器函数是一种特殊的方法，用于在创建模型实例或更新模型属性时执行自定义的验证逻辑。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@model_validator(<span class="params">mode=<span class="string">&quot;after&quot;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">validate_engine_and_run_func</span>(<span class="params">self</span>):</span></span><br><span class="line">    <span class="keyword">if</span> self.search_engine <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        self.search_engine = SearchEngine.from_search_config(self.config.search, proxy=self.config.proxy)</span><br><span class="line">    <span class="keyword">return</span> self</span><br></pre></td></tr></table></figure><p>或</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@model_validator(<span class="params">mode=<span class="string">&quot;before&quot;</span></span>)</span></span><br><span class="line"><span class="meta">@classmethod</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">validate_google</span>(<span class="params">cls, values: <span class="built_in">dict</span></span>) -&gt; <span class="built_in">dict</span>:</span></span><br><span class="line">  ...</span><br><span class="line">  </span><br><span class="line">其中values 是实例化对象的所有参数</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;model-validator&quot;&gt;&lt;a href=&quot;#model-validator&quot; class=&quot;headerlink&quot; title=&quot;model_validator&quot;&gt;&lt;/a&gt;model_validator&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;code</summary>
      
    
    
    
    <category term="python" scheme="https://www.willshirley.top/categories/python/"/>
    
    
    <category term="pydantic" scheme="https://www.willshirley.top/tags/pydantic/"/>
    
  </entry>
  
  <entry>
    <title>llm agent</title>
    <link href="https://www.willshirley.top/2024/01/24/llm%20agent/"/>
    <id>https://www.willshirley.top/2024/01/24/llm%20agent/</id>
    <published>2024-01-24T04:21:30.000Z</published>
    <updated>2024-03-12T02:09:24.219Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>Agent = Large Language Model (LLM) + Observation + Thought + Action + Memory</p><p>MultiAgent = Agents + Environment + Standard Operating Procedure (SOP) + Communication + Economy</p><p>ReAct<a href="https://learnprompting.org/zh-Hans/docs/advanced_applications/react#fn-1">1</a>(reason, act) 是一种使用自然语言推理解决复杂任务的语言模型范例，ReAct旨在用于允许LLM执行某些操作的任务</p></blockquote><hr><p><strong>reference</strong></p><ul><li><a href="https://www.ionio.ai/blog/what-is-llm-agent-ultimate-guide-to-llm-agent-with-technical-breakdown">https://www.ionio.ai/blog/what-is-llm-agent-ultimate-guide-to-llm-agent-with-technical-breakdown</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;Agent = Large Language Model (LLM) + Observation + Thought + Action + Memory&lt;/p&gt;
&lt;p&gt;MultiAgent = Agents + Environment + Stan</summary>
      
    
    
    
    <category term="llm" scheme="https://www.willshirley.top/categories/llm/"/>
    
    
    <category term="agent" scheme="https://www.willshirley.top/tags/agent/"/>
    
  </entry>
  
  <entry>
    <title>raycast awesome</title>
    <link href="https://www.willshirley.top/2024/01/22/raycast/"/>
    <id>https://www.willshirley.top/2024/01/22/raycast/</id>
    <published>2024-01-22T05:20:28.000Z</published>
    <updated>2024-03-01T03:46:06.585Z</updated>
    
    <content type="html"><![CDATA[<h2 id="extension"><a href="#extension" class="headerlink" title="extension"></a>extension</h2><h2 id="cake"><a href="#cake" class="headerlink" title="cake"></a>cake</h2><ul><li><p>庆祝彩纸</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">confetti</span><br></pre></td></tr></table></figure></li><li><p>弹跳窗口</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Toggle Bounce Animation</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;extension&quot;&gt;&lt;a href=&quot;#extension&quot; class=&quot;headerlink&quot; title=&quot;extension&quot;&gt;&lt;/a&gt;extension&lt;/h2&gt;&lt;h2 id=&quot;cake&quot;&gt;&lt;a href=&quot;#cake&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="tool" scheme="https://www.willshirley.top/categories/tool/"/>
    
    
    <category term="raycast" scheme="https://www.willshirley.top/tags/raycast/"/>
    
  </entry>
  
  <entry>
    <title>keyboard</title>
    <link href="https://www.willshirley.top/2024/01/19/keyboards/"/>
    <id>https://www.willshirley.top/2024/01/19/keyboards/</id>
    <published>2024-01-19T05:58:08.000Z</published>
    <updated>2024-03-13T03:10:05.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="niz-plum"><a href="#niz-plum" class="headerlink" title="niz plum"></a>niz plum</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">对照</span><br><span class="line">ctrl -&gt; control</span><br><span class="line">win/lock -&gt; option</span><br><span class="line">alt -&gt; command</span><br></pre></td></tr></table></figure><ul><li><p>锁定键盘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">右Fn + Esc</span><br></pre></td></tr></table></figure></li><li><p>电源与蓝牙切换</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Fn + F11键</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>屏幕移动</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctrl + win(option)</span><br></pre></td></tr></table></figure></li><li><p>win / alt 按键切换 （匹配win/mac系统）</p><p>```<br>Fn + Alt 三秒</p></li></ul><hr><ul><li><p>reference</p><p><a href="https://blog.csdn.net/qq_43528451/article/details/113357550">https://blog.csdn.net/qq_43528451/article/details/113357550</a></p></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;niz-plum&quot;&gt;&lt;a href=&quot;#niz-plum&quot; class=&quot;headerlink&quot; title=&quot;niz plum&quot;&gt;&lt;/a&gt;niz plum&lt;/h1&gt;&lt;figure class=&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;t</summary>
      
    
    
    
    <category term="keyboard" scheme="https://www.willshirley.top/categories/keyboard/"/>
    
    
    <category term="tool" scheme="https://www.willshirley.top/tags/tool/"/>
    
  </entry>
  
  <entry>
    <title>finite state machine</title>
    <link href="https://www.willshirley.top/2024/01/19/finite%20state%20machine/"/>
    <id>https://www.willshirley.top/2024/01/19/finite%20state%20machine/</id>
    <published>2024-01-19T03:13:16.000Z</published>
    <updated>2024-05-28T10:02:45.542Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>The FSM can change from one state to another in response to some inputs; the change from one state to another is called a <em>transition</em>.</p></blockquote><p><img src="./images/fsm/Automata_theory.png"></p><hr><p><strong>reference</strong></p><ul><li><a href="https://en.wikipedia.org/wiki/Finite-state_machine">https://en.wikipedia.org/wiki/Finite-state_machine</a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;blockquote&gt;
&lt;p&gt;The FSM can change from one state to another in response to some inputs; the change from one state to another is called a &lt;e</summary>
      
    
    
    
    <category term="fsm" scheme="https://www.willshirley.top/categories/fsm/"/>
    
    
    <category term="fsm" scheme="https://www.willshirley.top/tags/fsm/"/>
    
  </entry>
  
  <entry>
    <title>openai learn</title>
    <link href="https://www.willshirley.top/2024/01/19/openai%20learn/"/>
    <id>https://www.willshirley.top/2024/01/19/openai%20learn/</id>
    <published>2024-01-19T02:07:04.000Z</published>
    <updated>2024-03-12T02:07:10.964Z</updated>
    
    <content type="html"><![CDATA[<h1 id="UI"><a href="#UI" class="headerlink" title="UI"></a>UI</h1><h1 id="request"><a href="#request" class="headerlink" title="request"></a>request</h1><h3 id="conversion"><a href="#conversion" class="headerlink" title="conversion"></a>conversion</h3><ul><li><p>request</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl POST https://chat.openai.com/backend-api/conversation</span><br></pre></td></tr></table></figure></li><li><p>payload</p></li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;action&quot;</span>: <span class="string">&quot;next&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;messages&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;id&quot;</span>: <span class="string">&quot;aaa25811-d62c-4f23-963a-77c6eb90b899&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;author&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;content&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;content_type&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;parts&quot;</span>: [</span><br><span class="line">          <span class="string">&quot;你是如何带上上下文进行问答的，用python代码说下示例&quot;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;metadata&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;conversation_id&quot;</span>: <span class="string">&quot;0e02cc29-8cc2-4305-91a1-a3db1427f400&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;parent_message_id&quot;</span>: <span class="string">&quot;36d4ff94-fb3f-4f9b-beeb-d9c93f5752fe&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;model&quot;</span>: <span class="string">&quot;text-davinci-002-render-sha&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;timezone_offset_min&quot;</span>: <span class="number">-480</span>,</span><br><span class="line">  <span class="attr">&quot;suggestions&quot;</span>: [],</span><br><span class="line">  <span class="attr">&quot;history_and_training_disabled&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;arkose_token&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">&quot;conversation_mode&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;kind&quot;</span>: <span class="string">&quot;primary_assistant&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;force_paragen&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">&quot;force_rate_limit&quot;</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ces-v1-t"><a href="#ces-v1-t" class="headerlink" title="ces/v1/t"></a>ces/v1/t</h3><ul><li><p>request</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://chat.openai.com/ces/v1/t</span><br></pre></td></tr></table></figure></li><li><p>payload</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;timestamp&quot;</span>: <span class="string">&quot;2024-01-19T08:35:53.805Z&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;integrations&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;Segment.io&quot;</span>: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;userId&quot;</span>: <span class="string">&quot;user-EyJTf0sEV6sYCFhgOwqCHGD2&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;anonymousId&quot;</span>: <span class="string">&quot;dafc8561-54d1-4cb8-9cdf-91e5e4f7162e&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;event&quot;</span>: <span class="string">&quot;View Template Prompt Ignore Suggestions&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;type&quot;</span>: <span class="string">&quot;track&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;properties&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;origin&quot;</span>: <span class="string">&quot;chat&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;openai_app&quot;</span>: <span class="string">&quot;API&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;context&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;page&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;path&quot;</span>: <span class="string">&quot;/c/0e02cc29-8cc2-4305-91a1-a3db1427f400&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;referrer&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;search&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;title&quot;</span>: <span class="string">&quot;feel&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;https://chat.openai.com/c/0e02cc29-8cc2-4305-91a1-a3db1427f400&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;userAgent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;locale&quot;</span>: <span class="string">&quot;zh-CN&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;library&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;analytics.js&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;npm:next-1.56.0&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;userAgentData&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;brands&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;brand&quot;</span>: <span class="string">&quot;Not_A Brand&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;8&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;brand&quot;</span>: <span class="string">&quot;Chromium&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;120&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">&quot;brand&quot;</span>: <span class="string">&quot;Google Chrome&quot;</span>,</span><br><span class="line">          <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;120&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">&quot;mobile&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">&quot;platform&quot;</span>: <span class="string">&quot;macOS&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;messageId&quot;</span>: <span class="string">&quot;ajs-next-c0f7b6265ed3eab440b0d44f21f53ffa&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;sentAt&quot;</span>: <span class="string">&quot;2024-01-19T08:35:54.068Z&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;_metadata&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;bundled&quot;</span>: [</span><br><span class="line">      <span class="string">&quot;Segment.io&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;unbundled&quot;</span>: [],</span><br><span class="line">    <span class="attr">&quot;bundledIds&quot;</span>: []</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="rgstr"><a href="#rgstr" class="headerlink" title="rgstr"></a>rgstr</h3><ul><li><p>request</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://events.statsigapi.net/v1/rgstr</span><br></pre></td></tr></table></figure></li><li><p>payload</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;events&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">&quot;eventName&quot;</span>: <span class="string">&quot;chatgpt_prompt_ignore_suggestions&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;user&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;userID&quot;</span>: <span class="string">&quot;user-EyJTf0sEV6sYCFhgOwqCHGD2&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;custom&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;is_paid&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">          <span class="attr">&quot;workspace_id&quot;</span>: <span class="string">&quot;b27c1f77-bb94-4e8f-a6d3-4b30a0eec927&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;locale&quot;</span>: <span class="string">&quot;zh-CN&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;statsigEnvironment&quot;</span>: &#123;</span><br><span class="line">          <span class="attr">&quot;tier&quot;</span>: <span class="string">&quot;production&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">&quot;value&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">&quot;metadata&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">&quot;time&quot;</span>: <span class="number">1705653353804</span>,</span><br><span class="line">      <span class="attr">&quot;statsigMetadata&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;currentPage&quot;</span>: <span class="string">&quot;https://chat.openai.com/c/0e02cc29-8cc2-4305-91a1-a3db1427f400&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">&quot;statsigMetadata&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;sdkType&quot;</span>: <span class="string">&quot;js-client&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;sdkVersion&quot;</span>: <span class="string">&quot;4.39.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;stableID&quot;</span>: <span class="string">&quot;f0eaa0cd-f15f-4d71-ab51-8a91e92aea53&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h3 id="backend-lat-r"><a href="#backend-lat-r" class="headerlink" title="backend/lat/r"></a>backend/lat/r</h3><ul><li><p>request</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://chat.openai.com/backend-api/lat/r</span><br></pre></td></tr></table></figure></li><li><p>payload</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;server_request_id&quot;</span>: <span class="string">&quot;847dbf366a92408c-SIN&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;model&quot;</span>: <span class="string">&quot;text-davinci-002-render-sha&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;preflight_time_ms&quot;</span>: <span class="number">0.09999990463256836</span>,</span><br><span class="line">  <span class="attr">&quot;count_tokens&quot;</span>: <span class="number">472</span>,</span><br><span class="line">  <span class="attr">&quot;ts_first_token_ms&quot;</span>: <span class="number">1548.7000000476837</span>,</span><br><span class="line">  <span class="attr">&quot;ts_max_token_time_ms&quot;</span>: <span class="number">764</span>,</span><br><span class="line">  <span class="attr">&quot;ts_mean_token_without_first_ms&quot;</span>: <span class="number">30.007855625922005</span>,</span><br><span class="line">  <span class="attr">&quot;ts_median_token_without_first_ms&quot;</span>: <span class="number">21.799999952316284</span>,</span><br><span class="line">  <span class="attr">&quot;ts_min_token_time_ms&quot;</span>: <span class="number">0.09999990463256836</span>,</span><br><span class="line">  <span class="attr">&quot;ts_p95_token_without_first_ms&quot;</span>: <span class="number">88.99999988079071</span>,</span><br><span class="line">  <span class="attr">&quot;ts_p99_token_without_first_ms&quot;</span>: <span class="number">139.65999991893773</span>,</span><br><span class="line">  <span class="attr">&quot;ts_std_dev_token_ms&quot;</span>: <span class="number">44.98320283392762</span>,</span><br><span class="line">  <span class="attr">&quot;ts_total_request_ms&quot;</span>: <span class="number">15695.399999856949</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><h2 id="client-chat-completions-create"><a href="#client-chat-completions-create" class="headerlink" title="client.chat.completions.create"></a>client.chat.completions.create</h2><ul><li><p>request</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">response = client.chat.completions.create(</span><br><span class="line">           model=<span class="string">&quot;gpt-3.5-turbo-1106&quot;</span>,</span><br><span class="line">           messages=[</span><br><span class="line">               &#123;</span><br><span class="line">                   <span class="attr">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>,</span><br><span class="line">                   <span class="attr">&quot;content&quot;</span>: prompt_str,</span><br><span class="line">               &#125;,</span><br><span class="line">               &#123;</span><br><span class="line">                   <span class="attr">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">                   <span class="attr">&quot;content&quot;</span>: user_input.question,</span><br><span class="line">               &#125;,</span><br><span class="line">           ],</span><br><span class="line">       )</span><br></pre></td></tr></table></figure></li><li><p>response</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;id&quot;</span>: <span class="string">&quot;chatcmpl-8ify2KU1ANzQPQyD8WVMp6rZWgYtj&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;choices&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">&quot;finish_reason&quot;</span>: <span class="string">&quot;stop&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;index&quot;</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">&quot;logprobs&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">            <span class="attr">&quot;message&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;content&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;function_call&quot;</span>: <span class="literal">null</span>,</span><br><span class="line">                <span class="attr">&quot;tool_calls&quot;</span>: <span class="literal">null</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;created&quot;</span>: <span class="number">1705658446</span>,</span><br><span class="line">    <span class="attr">&quot;model&quot;</span>: <span class="string">&quot;gpt-3.5-turbo-1106&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;object&quot;</span>: <span class="string">&quot;chat.completion&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;system_fingerprint&quot;</span>: <span class="string">&quot;fp_c596c86df9&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;usage&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;completion_tokens&quot;</span>: <span class="number">51</span>,</span><br><span class="line">        <span class="attr">&quot;prompt_tokens&quot;</span>: <span class="number">1068</span>,</span><br><span class="line">        <span class="attr">&quot;total_tokens&quot;</span>: <span class="number">1119</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;UI&quot;&gt;&lt;a href=&quot;#UI&quot; class=&quot;headerlink&quot; title=&quot;UI&quot;&gt;&lt;/a&gt;UI&lt;/h1&gt;&lt;h1 id=&quot;request&quot;&gt;&lt;a href=&quot;#request&quot; class=&quot;headerlink&quot; title=&quot;request&quot;&gt;&lt;/</summary>
      
    
    
    
    <category term="fragment" scheme="https://www.willshirley.top/categories/fragment/"/>
    
    
    <category term="snippet" scheme="https://www.willshirley.top/tags/snippet/"/>
    
  </entry>
  
</feed>
